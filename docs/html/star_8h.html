<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Sun position: star.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Sun position
   &#160;<span id="projectnumber">0.1.6-1</span>
   </div>
   <div id="projectbrief">Sun position algorithm</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('star_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">star.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="star_8h.html" title="star.h - Astronomical conversion routines for stars and other objects beyond the Solar System">star.h</a> - Astronomical conversion routines for stars and other objects beyond the Solar System  
<a href="#details">More...</a></p>

<p><a href="star_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_star___catalog_posn.html">Star_CatalogPosn</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Catalogue position of a celestial object.  <a href="struct_star___catalog_posn.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a7963b31accfdc589a96ddb170b498bcd"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcd">Star_CoordSys</a> { <br />
&#160;&#160;<a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcda5e71501ef6e00c9330641e65276af6a1">APPARENT</a>, 
<a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcdad970266ef8bce3b5290badb6bddc220b">INTERMEDIATE</a>, 
<a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcda079b654048ef0c17bb6c6a95c00d2241">FK4</a>, 
<a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcdad53112050056585365eccaa3f4ad3708">FK5</a>, 
<br />
&#160;&#160;<a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcdafec2a8752f8fd387e9ae5565fea4c6f5">ICRS</a>
<br />
 }</td></tr>
<tr class="memdesc:a7963b31accfdc589a96ddb170b498bcd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Coordinate system equator and origin.  <a href="star_8h.html#a7963b31accfdc589a96ddb170b498bcd">More...</a><br /></td></tr>
<tr class="separator:a7963b31accfdc589a96ddb170b498bcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14fca560e34f3dd3907e9eddf2a669c0"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="star_8h.html#a14fca560e34f3dd3907e9eddf2a669c0">Star_CoordErrors</a> { <br />
&#160;&#160;<a class="el" href="star_8h.html#a14fca560e34f3dd3907e9eddf2a669c0a8629a807815e337e37d6d50b15aee053">STAR_NORMAL</a>, 
<a class="el" href="star_8h.html#a14fca560e34f3dd3907e9eddf2a669c0afb659b5d7b1453eb7c1184cd4a04121b">STAR_IVEPOCH</a>, 
<a class="el" href="star_8h.html#a14fca560e34f3dd3907e9eddf2a669c0aea9de18a36e6921e4c4cd1279b7836a6">STAR_ERRINOBJ</a>, 
<a class="el" href="star_8h.html#a14fca560e34f3dd3907e9eddf2a669c0a6e92139de0b82dab90ab5ade98d864e6">STAR_NORA</a>, 
<br />
&#160;&#160;<a class="el" href="star_8h.html#a14fca560e34f3dd3907e9eddf2a669c0ae773674f6d36d014c8f79ede50577689">STAR_ERRINRA</a>, 
<a class="el" href="star_8h.html#a14fca560e34f3dd3907e9eddf2a669c0a24eff5746088fbcc565e74e0d00569f1">STAR_RARANERR</a>, 
<a class="el" href="star_8h.html#a14fca560e34f3dd3907e9eddf2a669c0aed96cf80c337279ad9da0c4f8c9f9848">STAR_NODEC</a>, 
<a class="el" href="star_8h.html#a14fca560e34f3dd3907e9eddf2a669c0a4b8d53c217ffae04ba7ebe1f1584deea">STAR_ERRINDEC</a>, 
<br />
&#160;&#160;<a class="el" href="star_8h.html#a14fca560e34f3dd3907e9eddf2a669c0a21032339d2601bf630d8c8efe6e9ec91">STAR_DECRANERR</a>, 
<a class="el" href="star_8h.html#a14fca560e34f3dd3907e9eddf2a669c0ae1861b86b5f61ab64d95e51d72bcf5e9">STAR_ERRINMURA</a>, 
<a class="el" href="star_8h.html#a14fca560e34f3dd3907e9eddf2a669c0a9da9405d5dbd7ae2f8c5f143abb2ba70">STAR_ERRINMUDEC</a>, 
<a class="el" href="star_8h.html#a14fca560e34f3dd3907e9eddf2a669c0ad527d7d60372f66ed77d0384c50a0959">STAR_NOMUDEC</a>, 
<br />
&#160;&#160;<a class="el" href="star_8h.html#a14fca560e34f3dd3907e9eddf2a669c0a0d5162779bebf4b6ce6ad37ece9f524f">STAR_NOMURA</a>, 
<a class="el" href="star_8h.html#a14fca560e34f3dd3907e9eddf2a669c0a0e0323b2fca1b59dee6767d40600707a">STAR_ERRINPARAL</a>, 
<a class="el" href="star_8h.html#a14fca560e34f3dd3907e9eddf2a669c0ac31d2a52cf4b16125382fd621efc0cf4">STAR_PINEEDSPM</a>, 
<a class="el" href="star_8h.html#a14fca560e34f3dd3907e9eddf2a669c0ae311fc459b13b145d46e0c9d17faf6e8">STAR_ERRINVR</a>, 
<br />
&#160;&#160;<a class="el" href="star_8h.html#a14fca560e34f3dd3907e9eddf2a669c0a24c365d47754130e7f0e3057eb55b831">STAR_VRNEEDSPM</a>
<br />
 }</td></tr>
<tr class="memdesc:a14fca560e34f3dd3907e9eddf2a669c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Errors detected when decoding a text coordinate string or when filling a block of type <a class="el" href="struct_star___catalog_posn.html" title="Catalogue position of a celestial object.">Star_CatalogPosn</a> with numerical data.  <a href="star_8h.html#a14fca560e34f3dd3907e9eddf2a669c0">More...</a><br /></td></tr>
<tr class="separator:a14fca560e34f3dd3907e9eddf2a669c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abd961d5b0052011eb7b0edb786dacb3a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="star_8h.html#abd961d5b0052011eb7b0edb786dacb3a">star_setCurrentObject</a> (const <a class="el" href="struct_star___catalog_posn.html">Star_CatalogPosn</a> *c)</td></tr>
<tr class="memdesc:abd961d5b0052011eb7b0edb786dacb3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies the catalogue information in <em>c</em> to internal storage for later use by <a class="el" href="star_8h.html#a65152f6caf32ee5c581fe7e54994b952" title="Calculate the position of the currently selected star (or other object outside the solar system) as a...">star_getApparent()</a>  <a href="star_8h.html#abd961d5b0052011eb7b0edb786dacb3a">More...</a><br /></td></tr>
<tr class="separator:abd961d5b0052011eb7b0edb786dacb3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a767251b5f3f4f666a28d513fb9abfe99"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="star_8h.html#a767251b5f3f4f666a28d513fb9abfe99">star_catalogToApp</a> (const <a class="el" href="struct_star___catalog_posn.html">Star_CatalogPosn</a> *c, double j2kTT_cy, const <a class="el" href="struct_sky1___nut1980.html">Sky1_Nut1980</a> *nut, <a class="el" href="struct_v3_d___vector.html">V3D_Vector</a> *appV, double *dist_au)</td></tr>
<tr class="memdesc:a767251b5f3f4f666a28d513fb9abfe99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert the catalogue coordinates for a star (or other object outside the Solar System) to apparent coordinates at time <em>j2kTT_cy</em>.  <a href="star_8h.html#a767251b5f3f4f666a28d513fb9abfe99">More...</a><br /></td></tr>
<tr class="separator:a767251b5f3f4f666a28d513fb9abfe99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65152f6caf32ee5c581fe7e54994b952"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="star_8h.html#a65152f6caf32ee5c581fe7e54994b952">star_getApparent</a> (double j2kTT_cy, <a class="el" href="struct_sky___true_equatorial.html">Sky_TrueEquatorial</a> *pos)</td></tr>
<tr class="memdesc:a65152f6caf32ee5c581fe7e54994b952"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the position of the currently selected star (or other object outside the solar system) as a unit vector and a distance, in apparent coordinates.  <a href="star_8h.html#a65152f6caf32ee5c581fe7e54994b952">More...</a><br /></td></tr>
<tr class="separator:a65152f6caf32ee5c581fe7e54994b952"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18316f54644bd7ded2108492232be9d3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="star_8h.html#a18316f54644bd7ded2108492232be9d3">star_getTopocentric</a> (double j2kUtc_d, const <a class="el" href="struct_sky___delta_ts.html">Sky_DeltaTs</a> *deltas, const <a class="el" href="struct_sky___site_prop.html">Sky_SiteProp</a> *site, <a class="el" href="struct_sky___site_horizon.html">Sky_SiteHorizon</a> *topo)</td></tr>
<tr class="memdesc:a18316f54644bd7ded2108492232be9d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls <a class="el" href="star_8h.html#a65152f6caf32ee5c581fe7e54994b952" title="Calculate the position of the currently selected star (or other object outside the solar system) as a...">star_getApparent()</a> to calculate the star's position in apparent coordinates, and then converts this to topocentric horizon coordinates at the specified site.  <a href="star_8h.html#a18316f54644bd7ded2108492232be9d3">More...</a><br /></td></tr>
<tr class="separator:a18316f54644bd7ded2108492232be9d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85af3defd7b665fa7816320d18140083"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="star_8h.html#a85af3defd7b665fa7816320d18140083">star_setCatalogPosn</a> (const char objectName[], double ra_h, double dec_deg, <a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcd">Star_CoordSys</a> coordSys, double equinoxYear, double epochYear, double muRaSplat_maspa, double muDec_maspa, double annParallax_as, double radVel_kmps, <a class="el" href="struct_star___catalog_posn.html">Star_CatalogPosn</a> *coordBlock)</td></tr>
<tr class="memdesc:a85af3defd7b665fa7816320d18140083"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is one of three alternative routines for loading the information for a celestial object into a block of form <a class="el" href="struct_star___catalog_posn.html" title="Catalogue position of a celestial object.">Star_CatalogPosn</a>.  <a href="star_8h.html#a85af3defd7b665fa7816320d18140083">More...</a><br /></td></tr>
<tr class="separator:a85af3defd7b665fa7816320d18140083"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58afabdaee45bf62183b99290186d052"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="star_8h.html#a58afabdaee45bf62183b99290186d052">star_setCatalogOldStyle</a> (const char objectName[], double ra_h, double dec_deg, <a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcd">Star_CoordSys</a> coordSys, double equinoxYear, double epochYear, double muRa_spcy, double muDec_aspcy, double annParallax_as, double radVel_kmps, <a class="el" href="struct_star___catalog_posn.html">Star_CatalogPosn</a> *coordBlock)</td></tr>
<tr class="memdesc:a58afabdaee45bf62183b99290186d052"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is one of three alternative routines for loading the information for a celestial object into a block of form <a class="el" href="struct_star___catalog_posn.html" title="Catalogue position of a celestial object.">Star_CatalogPosn</a>.  <a href="star_8h.html#a58afabdaee45bf62183b99290186d052">More...</a><br /></td></tr>
<tr class="separator:a58afabdaee45bf62183b99290186d052"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a572ffa901457c2757acd7e3179d730af"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="star_8h.html#a572ffa901457c2757acd7e3179d730af">star_parseCoordString</a> (const char inStr[], <a class="el" href="struct_star___catalog_posn.html">Star_CatalogPosn</a> *coordBlock)</td></tr>
<tr class="memdesc:a572ffa901457c2757acd7e3179d730af"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is one of three alternative routines for loading the information for a celestial object into a block of form <a class="el" href="struct_star___catalog_posn.html" title="Catalogue position of a celestial object.">Star_CatalogPosn</a>.  <a href="star_8h.html#a572ffa901457c2757acd7e3179d730af">More...</a><br /></td></tr>
<tr class="separator:a572ffa901457c2757acd7e3179d730af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac67c8c6283dafc3327391b90a146908b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="star_8h.html#ac67c8c6283dafc3327391b90a146908b">star_catalogToVectors</a> (const <a class="el" href="struct_star___catalog_posn.html">Star_CatalogPosn</a> *c, <a class="el" href="struct_v3_d___vector.html">V3D_Vector</a> *pV, <a class="el" href="struct_v3_d___vector.html">V3D_Vector</a> *vV_radpcy)</td></tr>
<tr class="memdesc:ac67c8c6283dafc3327391b90a146908b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This routine takes the mean equatorial polar coordinate of an object and its proper motions, annual parallax (distance) and radial velocity, and computes the rectangular position and velocity vectors with respect to the same coordinate system.  <a href="star_8h.html#ac67c8c6283dafc3327391b90a146908b">More...</a><br /></td></tr>
<tr class="separator:ac67c8c6283dafc3327391b90a146908b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ae4ef23565464dd7c4fdc5a96a73be1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="star_8h.html#a9ae4ef23565464dd7c4fdc5a96a73be1">star_earth</a> (double t1_cy, const <a class="el" href="struct_v3_d___matrix.html">V3D_Matrix</a> *npM, <a class="el" href="struct_v3_d___vector.html">V3D_Vector</a> *ebV_au, <a class="el" href="struct_v3_d___vector.html">V3D_Vector</a> *ebdotV_aupd, <a class="el" href="struct_v3_d___vector.html">V3D_Vector</a> *sbV_au)</td></tr>
<tr class="memdesc:a9ae4ef23565464dd7c4fdc5a96a73be1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the position and velocity of the Earth, for use in making annual parallax and aberration corrections.  <a href="star_8h.html#a9ae4ef23565464dd7c4fdc5a96a73be1">More...</a><br /></td></tr>
<tr class="separator:a9ae4ef23565464dd7c4fdc5a96a73be1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace8bcb21c0df14bb736e91ff109837c2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="star_8h.html#ace8bcb21c0df14bb736e91ff109837c2">star_annAberr</a> (const <a class="el" href="struct_v3_d___vector.html">V3D_Vector</a> *p1V, const <a class="el" href="struct_v3_d___vector.html">V3D_Vector</a> *earthVelV_aupd, <a class="el" href="struct_v3_d___vector.html">V3D_Vector</a> *p2V)</td></tr>
<tr class="memdesc:ace8bcb21c0df14bb736e91ff109837c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply the annual aberration correction, to convert an object's coordinates from geocentric geometric direction to "proper" direction (still geocentric)  <a href="star_8h.html#ace8bcb21c0df14bb736e91ff109837c2">More...</a><br /></td></tr>
<tr class="separator:ace8bcb21c0df14bb736e91ff109837c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57013798a8682050b551700dc04fedc0"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="star_8h.html#a57013798a8682050b551700dc04fedc0">star_equinoxToStr</a> (const <a class="el" href="struct_star___catalog_posn.html">Star_CatalogPosn</a> *coordBlock, char equinoxStr[], size_t eqnxStrSize)</td></tr>
<tr class="memdesc:a57013798a8682050b551700dc04fedc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write the coordinate system and equinox out in a standard form.  <a href="star_8h.html#a57013798a8682050b551700dc04fedc0">More...</a><br /></td></tr>
<tr class="separator:a57013798a8682050b551700dc04fedc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69af3fc88ea12339c0e3423bd8d40134"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="star_8h.html#a69af3fc88ea12339c0e3423bd8d40134">star_epochToStr</a> (const <a class="el" href="struct_star___catalog_posn.html">Star_CatalogPosn</a> *coordBlock, char epochStr[], size_t epochStrSize)</td></tr>
<tr class="memdesc:a69af3fc88ea12339c0e3423bd8d40134"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write the epoch used for proper motion calculations out in a standard form.  <a href="star_8h.html#a69af3fc88ea12339c0e3423bd8d40134">More...</a><br /></td></tr>
<tr class="separator:a69af3fc88ea12339c0e3423bd8d40134"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="star_8h.html" title="star.h - Astronomical conversion routines for stars and other objects beyond the Solar System">star.h</a> - Astronomical conversion routines for stars and other objects beyond the Solar System </p>
<dl class="section author"><dt>Author</dt><dd>David Hoadley</dd></dl>
<p>Routines to convert a celestial object's catalogue position (as seen from the Solar System Barycentre) to a geocentric apparent position (as seen from the centre of the Earth). This means</p><ul>
<li>find the position and velocity of the Earth with respect to the Solar System Barycentre.</li>
<li>apply proper motion from the catalogue epoch to the desired epoch</li>
<li>offset the position by the position of the Earth (apply Annual Parallax)</li>
<li>use the velocity of the Earth to calculate the Annual Aberration correction</li>
</ul>
<p>The geocentric position calculated is then converted from the coordinate system of the catalogue position to apparent coordinates. (Exception: if the catalogue position is already in Celestial Intermediate coordinates, then the resulting vector will still be in Celestial Intermediate coordinates.)</p>
<hr  />
 
<p class="definition">Definition in file <a class="el" href="star_8h_source.html">star.h</a>.</p>
</div><h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a7963b31accfdc589a96ddb170b498bcd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7963b31accfdc589a96ddb170b498bcd">&#9670;&nbsp;</a></span>Star_CoordSys</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcd">Star_CoordSys</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Coordinate system equator and origin. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a7963b31accfdc589a96ddb170b498bcda5e71501ef6e00c9330641e65276af6a1"></a>APPARENT&#160;</td><td class="fielddoc"><p>True equator and equinox of date. </p>
</td></tr>
<tr><td class="fieldname"><a id="a7963b31accfdc589a96ddb170b498bcdad970266ef8bce3b5290badb6bddc220b"></a>INTERMEDIATE&#160;</td><td class="fielddoc"><p>True equator and CIO of date. </p>
</td></tr>
<tr><td class="fieldname"><a id="a7963b31accfdc589a96ddb170b498bcda079b654048ef0c17bb6c6a95c00d2241"></a>FK4&#160;</td><td class="fielddoc"><p>Mean equator and equinox of Besselian epoch. </p>
</td></tr>
<tr><td class="fieldname"><a id="a7963b31accfdc589a96ddb170b498bcdad53112050056585365eccaa3f4ad3708"></a>FK5&#160;</td><td class="fielddoc"><p>Mean equator and equinox of Julian epoch. </p>
</td></tr>
<tr><td class="fieldname"><a id="a7963b31accfdc589a96ddb170b498bcdafec2a8752f8fd387e9ae5565fea4c6f5"></a>ICRS&#160;</td><td class="fielddoc"><p>International Celestial Reference System. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="star_8h_source.html#l00069">69</a> of file <a class="el" href="star_8h_source.html">star.h</a>.</p>

</div>
</div>
<a id="a14fca560e34f3dd3907e9eddf2a669c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14fca560e34f3dd3907e9eddf2a669c0">&#9670;&nbsp;</a></span>Star_CoordErrors</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="star_8h.html#a14fca560e34f3dd3907e9eddf2a669c0">Star_CoordErrors</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Errors detected when decoding a text coordinate string or when filling a block of type <a class="el" href="struct_star___catalog_posn.html" title="Catalogue position of a celestial object.">Star_CatalogPosn</a> with numerical data. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a14fca560e34f3dd3907e9eddf2a669c0a8629a807815e337e37d6d50b15aee053"></a>STAR_NORMAL&#160;</td><td class="fielddoc"><p>Normal successful completion. </p>
</td></tr>
<tr><td class="fieldname"><a id="a14fca560e34f3dd3907e9eddf2a669c0afb659b5d7b1453eb7c1184cd4a04121b"></a>STAR_IVEPOCH&#160;</td><td class="fielddoc"><p>Invalid epoch or equinox specification. </p>
</td></tr>
<tr><td class="fieldname"><a id="a14fca560e34f3dd3907e9eddf2a669c0aea9de18a36e6921e4c4cd1279b7836a6"></a>STAR_ERRINOBJ&#160;</td><td class="fielddoc"><p>Error extracting object name from the string. </p>
<p>(comma missing at end?, or name started with a double quote char but there was no closing double-quote?) </p>
</td></tr>
<tr><td class="fieldname"><a id="a14fca560e34f3dd3907e9eddf2a669c0a6e92139de0b82dab90ab5ade98d864e6"></a>STAR_NORA&#160;</td><td class="fielddoc"><p>Specification of Right Ascension is missing. </p>
</td></tr>
<tr><td class="fieldname"><a id="a14fca560e34f3dd3907e9eddf2a669c0ae773674f6d36d014c8f79ede50577689"></a>STAR_ERRINRA&#160;</td><td class="fielddoc"><p>Right Ascension can't be decoded. </p>
</td></tr>
<tr><td class="fieldname"><a id="a14fca560e34f3dd3907e9eddf2a669c0a24eff5746088fbcc565e74e0d00569f1"></a>STAR_RARANERR&#160;</td><td class="fielddoc"><p>Right Ascension out of range. </p>
</td></tr>
<tr><td class="fieldname"><a id="a14fca560e34f3dd3907e9eddf2a669c0aed96cf80c337279ad9da0c4f8c9f9848"></a>STAR_NODEC&#160;</td><td class="fielddoc"><p>Specification of Declination is missing. </p>
</td></tr>
<tr><td class="fieldname"><a id="a14fca560e34f3dd3907e9eddf2a669c0a4b8d53c217ffae04ba7ebe1f1584deea"></a>STAR_ERRINDEC&#160;</td><td class="fielddoc"><p>Declination can't be decoded. </p>
</td></tr>
<tr><td class="fieldname"><a id="a14fca560e34f3dd3907e9eddf2a669c0a21032339d2601bf630d8c8efe6e9ec91"></a>STAR_DECRANERR&#160;</td><td class="fielddoc"><p>Declination out of range. </p>
</td></tr>
<tr><td class="fieldname"><a id="a14fca560e34f3dd3907e9eddf2a669c0ae1861b86b5f61ab64d95e51d72bcf5e9"></a>STAR_ERRINMURA&#160;</td><td class="fielddoc"><p>Proper motion in RA can't be decoded. </p>
</td></tr>
<tr><td class="fieldname"><a id="a14fca560e34f3dd3907e9eddf2a669c0a9da9405d5dbd7ae2f8c5f143abb2ba70"></a>STAR_ERRINMUDEC&#160;</td><td class="fielddoc"><p>Proper motion in Declination can't be decoded. </p>
</td></tr>
<tr><td class="fieldname"><a id="a14fca560e34f3dd3907e9eddf2a669c0ad527d7d60372f66ed77d0384c50a0959"></a>STAR_NOMUDEC&#160;</td><td class="fielddoc"><p>Specification of proper motion in Dec is missing when mu_ra was provided. </p>
<p>Check commas in string </p>
</td></tr>
<tr><td class="fieldname"><a id="a14fca560e34f3dd3907e9eddf2a669c0a0d5162779bebf4b6ce6ad37ece9f524f"></a>STAR_NOMURA&#160;</td><td class="fielddoc"><p>Specification of proper motion in RA is missing when mu_dec was provided. </p>
<p>Check commas in string </p>
</td></tr>
<tr><td class="fieldname"><a id="a14fca560e34f3dd3907e9eddf2a669c0a0e0323b2fca1b59dee6767d40600707a"></a>STAR_ERRINPARAL&#160;</td><td class="fielddoc"><p>Parallax can't be decoded. </p>
</td></tr>
<tr><td class="fieldname"><a id="a14fca560e34f3dd3907e9eddf2a669c0ac31d2a52cf4b16125382fd621efc0cf4"></a>STAR_PINEEDSPM&#160;</td><td class="fielddoc"><p>Proper motion must be specified if specifying parallax. </p>
</td></tr>
<tr><td class="fieldname"><a id="a14fca560e34f3dd3907e9eddf2a669c0ae311fc459b13b145d46e0c9d17faf6e8"></a>STAR_ERRINVR&#160;</td><td class="fielddoc"><p>Radial Velocity can't be decoded. </p>
</td></tr>
<tr><td class="fieldname"><a id="a14fca560e34f3dd3907e9eddf2a669c0a24c365d47754130e7f0e3057eb55b831"></a>STAR_VRNEEDSPM&#160;</td><td class="fielddoc"><p>Proper motion and parallax must be specified if specifying Radial Velocity. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="star_8h_source.html#l00098">98</a> of file <a class="el" href="star_8h_source.html">star.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="abd961d5b0052011eb7b0edb786dacb3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd961d5b0052011eb7b0edb786dacb3a">&#9670;&nbsp;</a></span>star_setCurrentObject()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void star_setCurrentObject </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_star___catalog_posn.html">Star_CatalogPosn</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copies the catalogue information in <em>c</em> to internal storage for later use by <a class="el" href="star_8h.html#a65152f6caf32ee5c581fe7e54994b952" title="Calculate the position of the currently selected star (or other object outside the solar system) as a...">star_getApparent()</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>The catalogue information for the star, as set by one of the three functions <a class="el" href="star_8h.html#a572ffa901457c2757acd7e3179d730af" title="This is one of three alternative routines for loading the information for a celestial object into a b...">star_parseCoordString()</a>, <a class="el" href="star_8h.html#a85af3defd7b665fa7816320d18140083" title="This is one of three alternative routines for loading the information for a celestial object into a b...">star_setCatalogPosn()</a> or <a class="el" href="star_8h.html#a58afabdaee45bf62183b99290186d052" title="This is one of three alternative routines for loading the information for a celestial object into a b...">star_setCatalogOldStyle()</a>.</td></tr>
  </table>
  </dd>
</dl>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="star_8c_source.html#l00135">135</a> of file <a class="el" href="star_8c_source.html">star.c</a>.</p>

</div>
</div>
<a id="a767251b5f3f4f666a28d513fb9abfe99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a767251b5f3f4f666a28d513fb9abfe99">&#9670;&nbsp;</a></span>star_catalogToApp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void star_catalogToApp </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_star___catalog_posn.html">Star_CatalogPosn</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>j2kTT_cy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_sky1___nut1980.html">Sky1_Nut1980</a> *&#160;</td>
          <td class="paramname"><em>nut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_v3_d___vector.html">V3D_Vector</a> *&#160;</td>
          <td class="paramname"><em>appV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dist_au</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert the catalogue coordinates for a star (or other object outside the Solar System) to apparent coordinates at time <em>j2kTT_cy</em>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>Catalogue position and motion of object, as set by one of the three functions <a class="el" href="star_8h.html#a572ffa901457c2757acd7e3179d730af" title="This is one of three alternative routines for loading the information for a celestial object into a b...">star_parseCoordString()</a>, <a class="el" href="star_8h.html#a85af3defd7b665fa7816320d18140083" title="This is one of three alternative routines for loading the information for a celestial object into a b...">star_setCatalogPosn()</a> or <a class="el" href="star_8h.html#a58afabdaee45bf62183b99290186d052" title="This is one of three alternative routines for loading the information for a celestial object into a b...">star_setCatalogOldStyle()</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">j2kTT_cy</td><td>Julian centuries since J2000.0, TT timescale </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nut</td><td>Nutation angles and obliquity of the ecliptic at time <em>j2kTT_cy</em>, as returned by functions <a class="el" href="sky1_8h.html#a61813485e959ed0208086d946e33ad4c" title="Calculates the nutation in longitude and obliquity, according to the IAU 1980 Nutation Theory.">sky1_nutationIAU1980()</a> and <a class="el" href="sky1_8h.html#a956ebf3c1277943e770093830777ca0d" title="Calculate the obliquity of the ecliptic and the equation of the equinoxes.">sky1_epsilon1980()</a> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">appV</td><td>Unit vector of geocentric apparent direction of object, referred to the true equator and equinox at time (<em>j2kTT_cy</em>) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dist_au</td><td>Distance to object (AU) as derived from <em>c-&gt;parallax_rad</em>.</td></tr>
  </table>
  </dd>
</dl>
<p>This routine is simplified, in that:</p><ul>
<li>It uses an approximate position for the Earth (calling <a class="el" href="star_8h.html#a9ae4ef23565464dd7c4fdc5a96a73be1" title="Calculate the position and velocity of the Earth, for use in making annual parallax and aberration co...">star_earth()</a>)</li>
<li>It does not apply relativistic corrections for gravitational light deflection; this effect is ignored.</li>
<li>Neither does it apply a relativistic annual aberration correction - it uses a simple vector sum of the earth's velocity to calculate annual aberration (calling <a class="el" href="star_8h.html#ace8bcb21c0df14bb736e91ff109837c2" title="Apply the annual aberration correction, to convert an object&#39;s coordinates from geocentric geometric ...">star_annAberr()</a>).</li>
</ul>
<dl class="section user"><dt>References:</dt><dd><em>Astronomical Almanac</em> 1987 pages B39-40, or<br  />
 <em>Astronomical Almanac</em> 2007 pages B66-67 </dd></dl>
<dl class="section note"><dt>Note</dt><dd>If the field <em>c-&gt;cSys</em> is equal to <a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcda079b654048ef0c17bb6c6a95c00d2241" title="Mean equator and equinox of Besselian epoch.">FK4</a>, this routine will return zero for the vector and distance. FK4 stellar positions are not supported (yet).</dd></dl>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="star_8c_source.html#l00148">148</a> of file <a class="el" href="star_8c_source.html">star.c</a>.</p>

</div>
</div>
<a id="a65152f6caf32ee5c581fe7e54994b952"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65152f6caf32ee5c581fe7e54994b952">&#9670;&nbsp;</a></span>star_getApparent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void star_getApparent </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>j2kTT_cy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_sky___true_equatorial.html">Sky_TrueEquatorial</a> *&#160;</td>
          <td class="paramname"><em>pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the position of the currently selected star (or other object outside the solar system) as a unit vector and a distance, in apparent coordinates. </p>
<p>It calls <a class="el" href="star_8h.html#a767251b5f3f4f666a28d513fb9abfe99" title="Convert the catalogue coordinates for a star (or other object outside the Solar System) to apparent c...">star_catalogToApp()</a> to obtain the star's position, after having called <a class="el" href="sky1_8h.html#a61813485e959ed0208086d946e33ad4c" title="Calculates the nutation in longitude and obliquity, according to the IAU 1980 Nutation Theory.">sky1_nutationIAU1980()</a> and <a class="el" href="sky1_8h.html#a956ebf3c1277943e770093830777ca0d" title="Calculate the obliquity of the ecliptic and the equation of the equinoxes.">sky1_epsilon1980()</a> to obtain the necessary nutation terms.</p>
<p>The star whose coordinates are obtained with this function is the star most recently specified with <a class="el" href="star_8h.html#abd961d5b0052011eb7b0edb786dacb3a" title="Copies the catalogue information in c to internal storage for later use by star_getApparent()">star_setCurrentObject()</a> </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">j2kTT_cy</td><td>Julian centuries since J2000.0, TT timescale </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pos</td><td>Timestamped structure containing position data in apparent coordinates and the equation of the equinoxes.</td></tr>
  </table>
  </dd>
</dl>
<p>This function is designed to be callable by the <a class="el" href="skyfast_8h.html#ac22205943c218e19d4313fc71dda43d4" title="Initialise those items that take a long time to calculate, but which do not need to be recalculated f...">skyfast_init()</a> and <a class="el" href="skyfast_8h.html#a3e351824c719ae6e465c1886a20a1a9c" title="Recalculation of the low frequency quantities.">skyfast_backgroundUpdate()</a> functions in a tracking application.</p>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="star_8c_source.html#l00315">315</a> of file <a class="el" href="star_8c_source.html">star.c</a>.</p>

</div>
</div>
<a id="a18316f54644bd7ded2108492232be9d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18316f54644bd7ded2108492232be9d3">&#9670;&nbsp;</a></span>star_getTopocentric()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void star_getTopocentric </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>j2kUtc_d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_sky___delta_ts.html">Sky_DeltaTs</a> *&#160;</td>
          <td class="paramname"><em>deltas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_sky___site_prop.html">Sky_SiteProp</a> *&#160;</td>
          <td class="paramname"><em>site</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_sky___site_horizon.html">Sky_SiteHorizon</a> *&#160;</td>
          <td class="paramname"><em>topo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls <a class="el" href="star_8h.html#a65152f6caf32ee5c581fe7e54994b952" title="Calculate the position of the currently selected star (or other object outside the solar system) as a...">star_getApparent()</a> to calculate the star's position in apparent coordinates, and then converts this to topocentric horizon coordinates at the specified site. </p>
<p>The star whose coordinates are obtained with this function is the star most recently specified with <a class="el" href="star_8h.html#abd961d5b0052011eb7b0edb786dacb3a" title="Copies the catalogue information in c to internal storage for later use by star_getApparent()">star_setCurrentObject()</a> </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">j2kUtc_d</td><td>UTC time in "J2KD" form - i.e days since J2000.0 (= JD - 2 451 545.0) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">deltas</td><td>Delta T values, as set by the <a class="el" href="sky_8h.html#abf770ba7cb996e73f59f41f24b172e3a" title="This is one of three alternative routines for setting up the various delta time values for use in ong...">sky_initTime()</a> (or <a class="el" href="sky_8h.html#a15ad9a782e54212cb22bd0658b6541a0" title="This is one of three alternative routines for setting up the various delta time values for use in ong...">sky_initTimeSimple()</a> or <a class="el" href="sky_8h.html#a4295dc6df66f02c4def3160782a06902" title="This is one of three alternative routines for setting up the various delta time values for use in ong...">sky_initTimeDetailed()</a>) routines </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">site</td><td>Properties of the observing site, particularly its geometric location on the surface of the Earth, as set by the <a class="el" href="sky_8h.html#a185862b772bcb6ef6eebf5cb33de09a6" title="Initialise the site structure by calculating those site-related values that do not change with time.">sky_setSiteLocation()</a> function (or <a class="el" href="sky_8h.html#a031a736d11ac57f7bf73cb8f68bb5aec" title="Alternative initialisation function to sky_setSiteLocation().">sky_setSiteLoc2()</a>) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">topo</td><td>Topocentric position, in both rectangular (unit vector) form, and as Azimuth and Elevation (altitude) angles</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>When to call this function</dt><dd>Use this function if you are calculating the star topocentric position once, for a single site. But if you are going to be calculating it repeatedly, or for multiple sites, use of this function will cause you to perform a great many needless recalculations. Use <a class="el" href="skyfast_8h.html#afb9144e153624a3bf899af40eca07ac0" title="Get the best approximation to the celestial object&#39;s apparent coordinates and distance,...">skyfast_getApprox()</a>, followed by <a class="el" href="sky1_8h.html#aa5023b9fbc0669c62f1422e13e5a6df1" title="Convert a position in geocentric apparent coordinates to geocentric coordinates in the Terrestrial In...">sky1_appToTirs()</a> and <a class="el" href="sky_8h.html#a0797b1e268ac7cc5b052c0623883eb74" title="Transform a coordinate vector from the Terrestrial Intermediate Reference System to topocentric Az/El...">sky_siteTirsToTopo()</a> instead.</dd></dl>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="star_8c_source.html#l00356">356</a> of file <a class="el" href="star_8c_source.html">star.c</a>.</p>

</div>
</div>
<a id="a85af3defd7b665fa7816320d18140083"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85af3defd7b665fa7816320d18140083">&#9670;&nbsp;</a></span>star_setCatalogPosn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int star_setCatalogPosn </td>
          <td>(</td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>objectName</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ra_h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dec_deg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcd">Star_CoordSys</a>&#160;</td>
          <td class="paramname"><em>coordSys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>equinoxYear</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>epochYear</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>muRaSplat_maspa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>muDec_maspa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>annParallax_as</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radVel_kmps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_star___catalog_posn.html">Star_CatalogPosn</a> *&#160;</td>
          <td class="paramname"><em>coordBlock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is one of three alternative routines for loading the information for a celestial object into a block of form <a class="el" href="struct_star___catalog_posn.html" title="Catalogue position of a celestial object.">Star_CatalogPosn</a>. </p>
<p>(The other two routines are <a class="el" href="star_8h.html#a58afabdaee45bf62183b99290186d052" title="This is one of three alternative routines for loading the information for a celestial object into a b...">star_setCatalogOldStyle()</a> and <a class="el" href="star_8h.html#a572ffa901457c2757acd7e3179d730af" title="This is one of three alternative routines for loading the information for a celestial object into a b...">star_parseCoordString()</a>.) </p><dl class="section return"><dt>Returns</dt><dd>An error code containing one of the values in Star_CoordErrors </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">objectName</td><td>Name of the object (optional) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ra_h</td><td>Right ascension (hours) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dec_deg</td><td>Declination (degrees) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coordSys</td><td>Coordinate system for RA and Dec </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">equinoxYear</td><td>Year of epoch of the mean equinox (if coordSys is <a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcda079b654048ef0c17bb6c6a95c00d2241" title="Mean equator and equinox of Besselian epoch.">FK4</a> or <a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcdad53112050056585365eccaa3f4ad3708" title="Mean equator and equinox of Julian epoch.">FK5</a>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">epochYear</td><td>Year of epoch for proper motion (if coordSys is <a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcdafec2a8752f8fd387e9ae5565fea4c6f5" title="International Celestial Reference System.">ICRS</a>, <a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcda079b654048ef0c17bb6c6a95c00d2241" title="Mean equator and equinox of Besselian epoch.">FK4</a> or <a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcdad53112050056585365eccaa3f4ad3708" title="Mean equator and equinox of Julian epoch.">FK5</a>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">muRaSplat_maspa</td><td>μα* - proper motion in RA, including the cos(δ) factor (milliarcseconds/year) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">muDec_maspa</td><td>μδ - proper motion in declination (milliarcseconds/year) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">annParallax_as</td><td>π - annual parallax (arcseconds) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">radVel_kmps</td><td>ν - radial velocity (km/s), positive away from the Earth </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">coordBlock</td><td>The block containing the data from all the input parameters, basically scaled into radians</td></tr>
  </table>
  </dd>
</dl>
<p>The difference between this routine and <a class="el" href="star_8h.html#a58afabdaee45bf62183b99290186d052" title="This is one of three alternative routines for loading the information for a celestial object into a b...">star_setCatalogOldStyle()</a> is in the way the proper motions in RA and Dec are specified. In this routine, μα* is specified in milliarcseconds per year, after scaling to absolute displacement on the sky by multiplying by cos(δ). μδ is also specified in milliarcseconds per year.</p>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="star_8c_source.html#l00763">763</a> of file <a class="el" href="star_8c_source.html">star.c</a>.</p>

</div>
</div>
<a id="a58afabdaee45bf62183b99290186d052"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58afabdaee45bf62183b99290186d052">&#9670;&nbsp;</a></span>star_setCatalogOldStyle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int star_setCatalogOldStyle </td>
          <td>(</td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>objectName</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ra_h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dec_deg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcd">Star_CoordSys</a>&#160;</td>
          <td class="paramname"><em>coordSys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>equinoxYear</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>epochYear</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>muRa_spcy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>muDec_aspcy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>annParallax_as</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radVel_kmps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_star___catalog_posn.html">Star_CatalogPosn</a> *&#160;</td>
          <td class="paramname"><em>coordBlock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is one of three alternative routines for loading the information for a celestial object into a block of form <a class="el" href="struct_star___catalog_posn.html" title="Catalogue position of a celestial object.">Star_CatalogPosn</a>. </p>
<p>(The other two routines are <a class="el" href="star_8h.html#a85af3defd7b665fa7816320d18140083" title="This is one of three alternative routines for loading the information for a celestial object into a b...">star_setCatalogPosn()</a> and <a class="el" href="star_8h.html#a572ffa901457c2757acd7e3179d730af" title="This is one of three alternative routines for loading the information for a celestial object into a b...">star_parseCoordString()</a>.) </p><dl class="section return"><dt>Returns</dt><dd>An error code containing one of the values in Star_CoordErrors </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">objectName</td><td>Name of the object (optional) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ra_h</td><td>Right ascension (hours) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dec_deg</td><td>Declination (degrees) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coordSys</td><td>Coordinate system for RA and Dec </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">equinoxYear</td><td>Year of epoch of the mean equinox (if coordSys is <a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcda079b654048ef0c17bb6c6a95c00d2241" title="Mean equator and equinox of Besselian epoch.">FK4</a> or <a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcdad53112050056585365eccaa3f4ad3708" title="Mean equator and equinox of Julian epoch.">FK5</a>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">epochYear</td><td>Year of epoch for proper motion (if coordSys is <a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcdafec2a8752f8fd387e9ae5565fea4c6f5" title="International Celestial Reference System.">ICRS</a>, <a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcda079b654048ef0c17bb6c6a95c00d2241" title="Mean equator and equinox of Besselian epoch.">FK4</a> or <a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcdad53112050056585365eccaa3f4ad3708" title="Mean equator and equinox of Julian epoch.">FK5</a>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">muRa_spcy</td><td>μα - proper motion in RA, <b>not</b> including the cos(δ) factor (seconds/century) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">muDec_aspcy</td><td>μδ - proper motion in declination (arcseconds/century) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">annParallax_as</td><td>π - annual parallax (arcseconds) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">radVel_kmps</td><td>ν - radial velocity (km/s), positive away from the Earth </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">coordBlock</td><td>The block containing the data from all the input parameters, basically scaled into radians</td></tr>
  </table>
  </dd>
</dl>
<p>The difference between this routine and <a class="el" href="star_8h.html#a85af3defd7b665fa7816320d18140083" title="This is one of three alternative routines for loading the information for a celestial object into a b...">star_setCatalogPosn()</a> is in the way the proper motions in RA and Dec are specified. In this routine, μα is specified in seconds (of time) per century, and is not scaled to absolute displacement on the sky. μδ is specified in arcseconds per century.</p>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="star_8c_source.html#l00868">868</a> of file <a class="el" href="star_8c_source.html">star.c</a>.</p>

</div>
</div>
<a id="a572ffa901457c2757acd7e3179d730af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a572ffa901457c2757acd7e3179d730af">&#9670;&nbsp;</a></span>star_parseCoordString()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int star_parseCoordString </td>
          <td>(</td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>inStr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_star___catalog_posn.html">Star_CatalogPosn</a> *&#160;</td>
          <td class="paramname"><em>coordBlock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is one of three alternative routines for loading the information for a celestial object into a block of form <a class="el" href="struct_star___catalog_posn.html" title="Catalogue position of a celestial object.">Star_CatalogPosn</a>. </p>
<p>(The other two routines are <a class="el" href="star_8h.html#a85af3defd7b665fa7816320d18140083" title="This is one of three alternative routines for loading the information for a celestial object into a b...">star_setCatalogPosn()</a> and <a class="el" href="star_8h.html#a58afabdaee45bf62183b99290186d052" title="This is one of three alternative routines for loading the information for a celestial object into a b...">star_setCatalogOldStyle()</a>.) </p><dl class="section return"><dt>Returns</dt><dd>An error code containing one of the values in Star_CoordErrors </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">inStr</td><td>The input string. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">coordBlock</td><td>The block containing the data from the input string, basically scaled into radians</td></tr>
  </table>
  </dd>
</dl>
<p>This routine decodes an input string which is of the form </p><pre class="fragment">    [name], RA, DEC[, Coords,[Epoch][, Mu_ra*, Mu_dec[, Pi[, Vr]]]]</pre><p> where the items shown inside square brackets are optional. This is basically a comma separated value (CSV) format. The text fields are as follows:</p><ul>
<li><b>name</b> - Object name. If the name is longer than the field <a class="el" href="struct_star___catalog_posn.html#a58c666a6e6c77b05ec72e9aa1cb648ce" title="Name of the celestial object (optional)">Star_CatalogPosn.objectName</a>, the extra characters will be lost.</li>
<li><b>RA</b> - Right Ascension. This has one to three numeric subfields, depending upon where the decimal point (if any) is placed. So it may be in the form of<ul>
<li>decimal hours (e.g. 12.582) (one subfield only)</li>
<li>hours and decimal minutes (e.g. 12:34.933 or 12 34.933) (two subfields)</li>
<li>hours, minutes and seconds (e.g. 12:34:56 or 12 34 56, or 12:34:56.78 or 12:34:56:78)</li>
</ul>
</li>
<li><b>DEC</b> - Declination. This also has one to three numeric subfields, as above. it may be in the form of<ul>
<li>decimal degrees (e.g. ±21.625 or ±21.625°)</li>
<li>degrees and decimal arcminutes (e.g. ±21 37.5 or ±21°37.5′)</li>
<li>degrees, arcminutes and arcseconds (e.g. ±21 37 30 or ±21°37′30″, or ±21 37 30.0 or ±21°37′30.0″)</li>
</ul>
</li>
</ul>
<p>In both of the above cases, the subfields may be separated by spaces, colons, degree, minute and seconds symbols, single and double quotes, or anything really. The parser is not fussy, and does not check.</p><ul>
<li><b>Coords</b> - the coordinate system reference for the coordinates. Valid values for this field are<ul>
<li><b>Apparent</b> - referred to true equinox and equator of date</li>
<li><b>Jnnnn.n</b> - FK5 position referred to mean equator and equinox of the specified Julian epoch (e.g. J2000)</li>
<li><b>Bnnnn.n</b> - FK4 position referred to mean equator and equinox of the specified Besselian epoch (e.g. B1950)</li>
<li><b>nnnn.n</b> - If not specified with a B or a J, values here before 1984.0 will be assumed to be FK4 (Besselian) and those after to be FK5 (Julian)</li>
<li><b>Intermediate</b> - Celestial Intermediate Reference System. This is referred to the true equator of date and the Celestial Intermediate Origin (CIO).</li>
<li><b>ICRS</b> - International Celestial Reference System</li>
</ul>
If this field is not specified, it will be assumed to be Apparent, and all following fields will be ignored.</li>
<li><b>Epoch</b> - Initial epoch for proper motion. If this field is omitted, the epoch is assumed to be the same as the coordinate system specification that precedes it. If that coordinate system is ICRS, then the epoch is assumed to be J2000.0 if is not specified. If the coordinate system is Apparent or Intermediate, the Epoch is ignored.</li>
<li><b>Mu_ra*</b> - proper motion in right ascension (milliarcseconds/year), including the cos(DEC) factor. This field will be ignored if Coords is set to Apparent or Intermediate</li>
<li><b>Mu_dec</b> - proper motion in declination (milliarcseconds/year). This field will be ignored if Coords is set to Apparent or Intermediate</li>
<li><b>Pi</b> - annual parallax (arcseconds) This field will be ignored if Coords is set to Apparent or Intermediate</li>
<li><b>Vr</b> - radial velocity (km/s), positive for objects moving away. This field will be ignored if Coords is set to Apparent or Intermediate</li>
</ul>
<p>The string format is fairly flexible. For example, fields may be separated with spaces rather than commas, so long as any omitted fields are at the end of the string. But if any fields not at the end are omitted, commas must be used to indicate the empty fields. </p><dl class="section note"><dt>Note</dt><dd>The facilities provided by the C language for text handling are rudimentary, and as a result, this routine is slightly fragile. In trying to be flexible but not too complex, the following limitation applies: Do not ever have white space immediately preceding a comma. If you do, the routine may go wrong. So, in particular this means that omitted fields (not at the end of the string) must be denoted by two successive commas with no space in between. <pre class="fragment">    Dummy, 12:34:56.789, +89°56′43.210″, J2000.0,, 23.455, 12.766
    Barnard's star, 17 57 48.500 +04 41 36.111 ICRS,, -802.803, 10362.542, 0.5474506, -110.353</pre></dd></dl>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="star_8c_source.html#l00972">972</a> of file <a class="el" href="star_8c_source.html">star.c</a>.</p>

</div>
</div>
<a id="ac67c8c6283dafc3327391b90a146908b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac67c8c6283dafc3327391b90a146908b">&#9670;&nbsp;</a></span>star_catalogToVectors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void star_catalogToVectors </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_star___catalog_posn.html">Star_CatalogPosn</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_v3_d___vector.html">V3D_Vector</a> *&#160;</td>
          <td class="paramname"><em>pV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_v3_d___vector.html">V3D_Vector</a> *&#160;</td>
          <td class="paramname"><em>vV_radpcy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This routine takes the mean equatorial polar coordinate of an object and its proper motions, annual parallax (distance) and radial velocity, and computes the rectangular position and velocity vectors with respect to the same coordinate system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>Catalog position and motion of object</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pV</td><td>Unit position vector (direction cosines) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vV_radpcy</td><td>Space velocity vector (radian/Julian century)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Reference:</dt><dd><em>Astronomical Almanac</em> 2007, pages B66 and B67</dd></dl>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="star_8c_source.html#l00403">403</a> of file <a class="el" href="star_8c_source.html">star.c</a>.</p>

</div>
</div>
<a id="a9ae4ef23565464dd7c4fdc5a96a73be1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ae4ef23565464dd7c4fdc5a96a73be1">&#9670;&nbsp;</a></span>star_earth()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void star_earth </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t1_cy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_v3_d___matrix.html">V3D_Matrix</a> *&#160;</td>
          <td class="paramname"><em>npM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_v3_d___vector.html">V3D_Vector</a> *&#160;</td>
          <td class="paramname"><em>ebV_au</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_v3_d___vector.html">V3D_Vector</a> *&#160;</td>
          <td class="paramname"><em>ebdotV_aupd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_v3_d___vector.html">V3D_Vector</a> *&#160;</td>
          <td class="paramname"><em>sbV_au</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the position and velocity of the Earth, for use in making annual parallax and aberration corrections. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t1_cy</td><td>Epoch of time of observation (Julian centuries since J2000.0, TT timescale) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">npM</td><td>Combined precession and nutation matrix <b>NP</b> that will be used to convert the coordinates of the star of interest from its catalogue mean place to apparent coordinates. It will be used in this routine to do the reverse - convert the apparent coordinates of the Earth's position back into mean coordinates at the catalogue epoch of the star. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ebV_au</td><td>Barycentric position of the Earth (AU) (vector <b>Eb</b> in <em>Astronomical Almanac</em>) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ebdotV_aupd</td><td>Velocity of the Earth (AU/day) (vector <b>Ėb</b> in <em>Astronomical Almanac</em>) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sbV_au</td><td>Barycentric position of the Sun (AU) (vector <b>Sb</b> in <em>Astronomical Almanac</em>)</td></tr>
  </table>
  </dd>
</dl>
<p>In theory, this is the barycentric position, and the values are referred to the same system as is used for the catalogue position of the star (such as J2000, or the Barycentric Celestial Reference System/ICRS). This can be obtained from the IAU SOFA routine <code>iauEpv00()</code>, calculated in fabulously complicated detail. But the parallax and aberration corrections are small, which means that the accuracy required of this routine is not actually that high.</p>
<p>So to save on computing resources in a tracking application, this routine uses instead the simple algorithm in the <em>Astronomical Almanac</em> for the Sun's position, entitled "Low-precision formulas for the Sun's
    coordinates..." It differentiates the position vector to obtain the Earth's velocity. So there are a few approximations here:</p><ol type="1">
<li>It calculates a heliocentric position, rather than a barycentric position</li>
<li>The algorithm itself is approximate - accurate to 0.01° between 1950 and 2050.</li>
<li>It does not calculate the barycentric position of the Sun at all. So <em>sbV_au</em> will be returned as a zero vector.</li>
</ol>
<p>But nonetheless, the effect on the final star position is very small. For example, the <em>Almanac</em> gives an example of stellar reduction calculations for a fictitious star, (which appears to be very close to Alpha Centauri). This star has about as much parallax as one is ever likely to see.</p>
<p>In the 2007 <em>Almanac</em>, page B68, the apparent position of this star at 2007 January 1, 0h TT , after performing a rigorous reduction, is</p><ul>
<li>RA = 14 40 03.4343 (hms), Dec = -60°51′37.770″</li>
</ul>
<p>The position obtained by using the approximations of <a class="el" href="star_8h.html#a767251b5f3f4f666a28d513fb9abfe99" title="Convert the catalogue coordinates for a star (or other object outside the Solar System) to apparent c...">star_catalogToApp()</a> (which calls this routine) and converts to apparent coordinates is</p><ul>
<li>RA = 14:40:03.4276 (hms), Dec = -60°51'37.782"</li>
</ul>
<p>which is clearly good enough for tracking.</p>
<p>In the 1987 <em>Almanac</em>, page B41, the apparent position of a (very slightly different) fictitious star at 1987 January 1, 0h TT is</p><ul>
<li>RA = 14 38 40.164 (hms), Dec = -60°46′44.82″</li>
</ul>
<p>The position obtained using the routines here (as above) is</p><ul>
<li>RA = 14:38:40.157 (hms), Dec = -60°46'44.84"</li>
</ul>
<p>For a more detailed look at this, see <a class="el" href="page-stellar-reduction-accuracy.html">Stellar reduction accuracy</a></p>
<dl class="section user"><dt>References:</dt><dd><em>Astronomical Almanac</em> 1987 pages B39 (method), B41 (example) and C24 (Sun position) or<br  />
 <em>Astronomical Almanac</em> 2007 pages B66 (method), B68 (example) and C24 (Sun position).</dd></dl>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="star_8c_source.html#l00461">461</a> of file <a class="el" href="star_8c_source.html">star.c</a>.</p>

</div>
</div>
<a id="ace8bcb21c0df14bb736e91ff109837c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace8bcb21c0df14bb736e91ff109837c2">&#9670;&nbsp;</a></span>star_annAberr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void star_annAberr </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_v3_d___vector.html">V3D_Vector</a> *&#160;</td>
          <td class="paramname"><em>p1V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_v3_d___vector.html">V3D_Vector</a> *&#160;</td>
          <td class="paramname"><em>earthVelV_aupd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_v3_d___vector.html">V3D_Vector</a> *&#160;</td>
          <td class="paramname"><em>p2V</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply the annual aberration correction, to convert an object's coordinates from geocentric geometric direction to "proper" direction (still geocentric) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p1V</td><td>Unit vector pointing to object's geometric direction as viewed from the centre of the earth. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">earthVelV_aupd</td><td>Earth velocity vector, referred to the J2000 mean equator and equinox, as returned by routine <a class="el" href="star_8h.html#a9ae4ef23565464dd7c4fdc5a96a73be1" title="Calculate the position and velocity of the Earth, for use in making annual parallax and aberration co...">star_earth()</a> (AU/day - not a unit vector) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">p2V</td><td>Unit vector pointing to object's proper direction</td></tr>
  </table>
  </dd>
</dl>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="star_8c_source.html#l00603">603</a> of file <a class="el" href="star_8c_source.html">star.c</a>.</p>

</div>
</div>
<a id="a57013798a8682050b551700dc04fedc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57013798a8682050b551700dc04fedc0">&#9670;&nbsp;</a></span>star_equinoxToStr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* star_equinoxToStr </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_star___catalog_posn.html">Star_CatalogPosn</a> *&#160;</td>
          <td class="paramname"><em>coordBlock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>equinoxStr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>eqnxStrSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write the coordinate system and equinox out in a standard form. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">coordBlock</td><td>Coordinate block describing the celestial object </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">equinoxStr</td><td>String to contain the coordinate system and equinox </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eqnxStrSize</td><td>Size of equinoxStr (i.e. maximum number of characters available for the output</td></tr>
  </table>
  </dd>
</dl>
<p>The output form depends upon the value of <em>coordBlock-&gt;cSys:</em> </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><em>coordBlock-&gt;cSys</em>  </th><th class="markdownTableHeadNone">Output  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcda5e71501ef6e00c9330641e65276af6a1" title="True equator and equinox of date.">APPARENT</a> </td><td class="markdownTableBodyNone">Apparent  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcdad970266ef8bce3b5290badb6bddc220b" title="True equator and CIO of date.">INTERMEDIATE</a> </td><td class="markdownTableBodyNone">Intermediate  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcda079b654048ef0c17bb6c6a95c00d2241" title="Mean equator and equinox of Besselian epoch.">FK4</a> </td><td class="markdownTableBodyNone">Bnnnn.n (n is numeric)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcdad53112050056585365eccaa3f4ad3708" title="Mean equator and equinox of Julian epoch.">FK5</a> </td><td class="markdownTableBodyNone">Jnnnn.n (n is numeric)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcdafec2a8752f8fd387e9ae5565fea4c6f5" title="International Celestial Reference System.">ICRS</a> </td><td class="markdownTableBodyNone">ICRS  </td></tr>
</table>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="star_8c_source.html#l00632">632</a> of file <a class="el" href="star_8c_source.html">star.c</a>.</p>

</div>
</div>
<a id="a69af3fc88ea12339c0e3423bd8d40134"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69af3fc88ea12339c0e3423bd8d40134">&#9670;&nbsp;</a></span>star_epochToStr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* star_epochToStr </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_star___catalog_posn.html">Star_CatalogPosn</a> *&#160;</td>
          <td class="paramname"><em>coordBlock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>epochStr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>epochStrSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write the epoch used for proper motion calculations out in a standard form. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">coordBlock</td><td>Coordinate block describing the celestial object </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">epochStr</td><td>String to contain the coordinate system and epoch </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">epochStrSize</td><td>Size of epochStr (i.e. maximum number of characters available for the output</td></tr>
  </table>
  </dd>
</dl>
<p>The output form depends upon the value of <em>coordBlock-&gt;cSys:</em> </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><em>coordBlock-&gt;cSys</em>  </th><th class="markdownTableHeadNone">Output  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcda5e71501ef6e00c9330641e65276af6a1" title="True equator and equinox of date.">APPARENT</a> </td><td class="markdownTableBodyNone">(empty string - epoch is irrelevant)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcdad970266ef8bce3b5290badb6bddc220b" title="True equator and CIO of date.">INTERMEDIATE</a> </td><td class="markdownTableBodyNone">(empty string - epoch is irrelevant)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcda079b654048ef0c17bb6c6a95c00d2241" title="Mean equator and equinox of Besselian epoch.">FK4</a> </td><td class="markdownTableBodyNone">Bnnnn.n (n is numeric)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcdad53112050056585365eccaa3f4ad3708" title="Mean equator and equinox of Julian epoch.">FK5</a> </td><td class="markdownTableBodyNone">Jnnnn.n (n is numeric)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="star_8h.html#a7963b31accfdc589a96ddb170b498bcdafec2a8752f8fd387e9ae5565fea4c6f5" title="International Celestial Reference System.">ICRS</a> </td><td class="markdownTableBodyNone">Jnnnn.n (n is numeric)  </td></tr>
</table>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="star_8c_source.html#l00698">698</a> of file <a class="el" href="star_8c_source.html">star.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="star_8h.html">star.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
