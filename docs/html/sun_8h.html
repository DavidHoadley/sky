<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>sunpos: src/sun.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">sunpos
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
   <div id="projectbrief">Sun position algorithm</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('sun_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">sun.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="sun_8h.html" title="sun.h - routines to calculate the Sun&#39;s position">sun.h</a> - routines to calculate the Sun's position  
<a href="#details">More...</a></p>

<p><a href="sun_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a697f8cd30a2c41f04cf775a41df23037"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sun_8h.html#a697f8cd30a2c41f04cf775a41df23037">sun_aaApparentApprox</a> (double n, <a class="el" href="struct_v3_d___vector.html">V3D_Vector</a> *appV, double *dist_au)</td></tr>
<tr class="memdesc:a697f8cd30a2c41f04cf775a41df23037"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function calculates an approximate Sun position in apparent coordinates using the algorithm given in the <em>Astronomical Almanac</em>.  <a href="sun_8h.html#a697f8cd30a2c41f04cf775a41df23037">More...</a><br /></td></tr>
<tr class="separator:a697f8cd30a2c41f04cf775a41df23037"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b8eff53c5adde4f9144a308aab0e8ba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sun_8h.html#a8b8eff53c5adde4f9144a308aab0e8ba">sun_nrelApp2</a> (double t_cy, const <a class="el" href="struct_sky0___nut1980.html">Sky0_Nut1980</a> *nut, <a class="el" href="struct_v3_d___vector.html">V3D_Vector</a> *appV, double *dist_au)</td></tr>
<tr class="memdesc:a8b8eff53c5adde4f9144a308aab0e8ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function calculates the Sun position in apparent coordinates, using the NREL SPA algorithm (see reference).  <a href="sun_8h.html#a8b8eff53c5adde4f9144a308aab0e8ba">More...</a><br /></td></tr>
<tr class="separator:a8b8eff53c5adde4f9144a308aab0e8ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a257ebc73aa83eef26448d451eeb086da"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sun_8h.html#a257ebc73aa83eef26448d451eeb086da">sun_nrelApparent</a> (double j2kTT_cy, <a class="el" href="struct_sky___true_equatorial.html">Sky_TrueEquatorial</a> *pos)</td></tr>
<tr class="memdesc:a257ebc73aa83eef26448d451eeb086da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the Sun's position as a unit vector and a distance, in apparent coordinates.  <a href="sun_8h.html#a257ebc73aa83eef26448d451eeb086da">More...</a><br /></td></tr>
<tr class="separator:a257ebc73aa83eef26448d451eeb086da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac555d348d21360e65ff644212d7f84b4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sun_8h.html#ac555d348d21360e65ff644212d7f84b4">sun_nrelTopocentric</a> (double j2kUtc_d, const <a class="el" href="struct_sky___delta_ts.html">Sky_DeltaTs</a> *deltas, const <a class="el" href="struct_sky___site_prop.html">Sky_SiteProp</a> *site, <a class="el" href="struct_sky___site_horizon.html">Sky_SiteHorizon</a> *topo)</td></tr>
<tr class="memdesc:ac555d348d21360e65ff644212d7f84b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls <a class="el" href="sun_8h.html#a257ebc73aa83eef26448d451eeb086da" title="Calculate the Sun&#39;s position as a unit vector and a distance, in apparent coordinates.">sun_nrelApparent()</a> to calculate the Sun's position in apparent coordinates using the NREL Sun Position Algorithm, and then converts this to topocentric horizon coordinates at the specified site.  <a href="sun_8h.html#ac555d348d21360e65ff644212d7f84b4">More...</a><br /></td></tr>
<tr class="separator:ac555d348d21360e65ff644212d7f84b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42caefa9705e53013331f3f3ec683de6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sun_8h.html#a42caefa9705e53013331f3f3ec683de6">sun_solarNoon</a> (int year, int month, int day, const <a class="el" href="struct_sky___delta_ts.html">Sky_DeltaTs</a> *deltas, const <a class="el" href="struct_sky___site_prop.html">Sky_SiteProp</a> *site, <a class="el" href="struct_sky___site_horizon.html">Sky_SiteHorizon</a> *topo)</td></tr>
<tr class="memdesc:a42caefa9705e53013331f3f3ec683de6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Routine to calculate the time of solar noon (Sun transit) for the day specified by <em>year</em>, <em>month</em> and <em>day</em>.  <a href="sun_8h.html#a42caefa9705e53013331f3f3ec683de6">More...</a><br /></td></tr>
<tr class="separator:a42caefa9705e53013331f3f3ec683de6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b95525b0966c30a2002fae909e6ebc5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sun_8h.html#a2b95525b0966c30a2002fae909e6ebc5">sun_riseSet</a> (int year, int month, int day, bool getSunrise, const <a class="el" href="struct_sky___delta_ts.html">Sky_DeltaTs</a> *deltas, const <a class="el" href="struct_sky___site_prop.html">Sky_SiteProp</a> *site, <a class="el" href="struct_sky___site_horizon.html">Sky_SiteHorizon</a> *topo)</td></tr>
<tr class="memdesc:a2b95525b0966c30a2002fae909e6ebc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Routine to calculate the time of sunrise or sunset for the day specified by <em>year</em>, <em>month</em> and <em>day</em>.  <a href="sun_8h.html#a2b95525b0966c30a2002fae909e6ebc5">More...</a><br /></td></tr>
<tr class="separator:a2b95525b0966c30a2002fae909e6ebc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="sun_8h.html" title="sun.h - routines to calculate the Sun&#39;s position">sun.h</a> - routines to calculate the Sun's position </p>
<dl class="section author"><dt>Author</dt><dd>David Hoadley</dd></dl>
<p>Alternative routines which calculate the sun's position with differing levels of accuracy. The alternatives are</p><ul>
<li>a low precision routine, taken from the <em>Astronomical Almanac</em></li>
<li>a much more detailed, high precision routine, based on the Solar Position Algorithm, as published by the National Renewable Energy Laboratory (referred to as the NREL SPA throughout this software)</li>
</ul>
<p>Rectangular coordinates are used wherever possible, to minimise the unnecessary recalculation of trigonometric functions.</p>
<dl class="section user"><dt>References:</dt><dd>The <em>Astronomical Almanac</em>, 2007, page C24<br  />
 Reda, Ibrahim and Andreas, Afshin, <em>Solar Position Algorithm for Solar Radiation Applications.</em> National Renewable Energy Laboratory publication no. NREL/TP-560-34302, June 2003, revised 2008.</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd><p class="startdd">Copyright (c) 2020, David Hoadley <a href="#" onclick="location.href='mai'+'lto:'+'vcr'+'um'+'ble'+'@w'+'est'+'ne'+'t.c'+'om'+'.au'; return false;">vcrum<span style="display: none;">.nosp@m.</span>ble@<span style="display: none;">.nosp@m.</span>westn<span style="display: none;">.nosp@m.</span>et.c<span style="display: none;">.nosp@m.</span>om.au</a> All rights reserved.</p>
<p class="interdd">Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</p>
<ul>
<li>Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</li>
<li>Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</li>
</ul>
<p class="enddd">THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. </p>
</dd></dl>
<hr  />
 
<p class="definition">Definition in file <a class="el" href="sun_8h_source.html">sun.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a697f8cd30a2c41f04cf775a41df23037"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a697f8cd30a2c41f04cf775a41df23037">&#9670;&nbsp;</a></span>sun_aaApparentApprox()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sun_aaApparentApprox </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_v3_d___vector.html">V3D_Vector</a> *&#160;</td>
          <td class="paramname"><em>appV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dist_au</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function calculates an approximate Sun position in apparent coordinates using the algorithm given in the <em>Astronomical Almanac</em>. </p>
<p>The quoted accuracy is a precision of 0.01 degrees between 1950 and 2050. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Days since J2000.0, UT1 timescale </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">appV</td><td>Position vector of Sun in apparent coordinates (unit vector i.e. direction cosines) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dist_au</td><td>Geocentric distance of the Sun (Astronomical Units)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>When to call this routine</dt><dd>Use this routine for a quick rough calculation of the Sun's position. If you need an accurate position, don't call this routine, call <a class="el" href="sun_8h.html#a257ebc73aa83eef26448d451eeb086da" title="Calculate the Sun&#39;s position as a unit vector and a distance, in apparent coordinates.">sun_nrelApparent()</a> instead.</dd></dl>
<dl class="section user"><dt>Reference:</dt><dd>The <em>Astronomical Almanac</em>, 2007, page C24</dd></dl>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="sun_8c_source.html#l00105">105</a> of file <a class="el" href="sun_8c_source.html">sun.c</a>.</p>

</div>
</div>
<a id="a8b8eff53c5adde4f9144a308aab0e8ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b8eff53c5adde4f9144a308aab0e8ba">&#9670;&nbsp;</a></span>sun_nrelApp2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sun_nrelApp2 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t_cy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_sky0___nut1980.html">Sky0_Nut1980</a> *&#160;</td>
          <td class="paramname"><em>nut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_v3_d___vector.html">V3D_Vector</a> *&#160;</td>
          <td class="paramname"><em>appV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dist_au</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function calculates the Sun position in apparent coordinates, using the NREL SPA algorithm (see reference). </p>
<p>The quoted accuracy of this algorithm os 0.0003° (or about 1 arcsecond). It is much more computationally intensive than the approximate algorithm from the <em>Astronomical Almanac</em> implemented by the routine <a class="el" href="sun_8h.html#a697f8cd30a2c41f04cf775a41df23037" title="This function calculates an approximate Sun position in apparent coordinates using the algorithm give...">sun_aaApparentApprox()</a>. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t_cy</td><td>Julian centuries since J2000.0, TT timescale </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nut</td><td>Nutation terms and obliquity of the ecliptic, as returned by functions <a class="el" href="sky0_8h.html#a7a264cd6849a45a5edc1c660c8b76aa6" title="Calculates the nutation in longitude and obliquity, according to the algorithm set out in the NREL SP...">sky0_nutationSpa()</a> and <a class="el" href="sky0_8h.html#a5955058c81d1be6ec0e466900c52c69e" title="Calculate the obliquity of the ecliptic and the equation of the equinoxes.">sky0_epsilonSpa()</a>.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">appV</td><td>Position vector of Sun in apparent coordinates (unit vector i.e. direction cosines) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dist_au</td><td>Geocentric distance of the Sun (Astronomical Units)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>When to call this function</dt><dd>In most cases, you will want to call <a class="el" href="sun_8h.html#a257ebc73aa83eef26448d451eeb086da" title="Calculate the Sun&#39;s position as a unit vector and a distance, in apparent coordinates.">sun_nrelApparent()</a> or <a class="el" href="sun_8h.html#ac555d348d21360e65ff644212d7f84b4" title="Calls sun_nrelApparent() to calculate the Sun&#39;s position in apparent coordinates using the NREL Sun P...">sun_nrelTopocentric()</a> instead, and those functions call this function for you.</dd></dl>
<dl class="section user"><dt>Reference:</dt><dd>Ibrahim Reda and Afshin Andreas, <em>Solar Position Algorithm for Solar Radiation Applications</em> National Renewable Energy Laboratory publication no. NREL/TP-560-34302, Revised January 2008</dd></dl>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="sun_8c_source.html#l00148">148</a> of file <a class="el" href="sun_8c_source.html">sun.c</a>.</p>

</div>
</div>
<a id="a257ebc73aa83eef26448d451eeb086da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a257ebc73aa83eef26448d451eeb086da">&#9670;&nbsp;</a></span>sun_nrelApparent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sun_nrelApparent </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>j2kTT_cy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_sky___true_equatorial.html">Sky_TrueEquatorial</a> *&#160;</td>
          <td class="paramname"><em>pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the Sun's position as a unit vector and a distance, in apparent coordinates. </p>
<p>It calls <a class="el" href="sun_8h.html#a8b8eff53c5adde4f9144a308aab0e8ba" title="This function calculates the Sun position in apparent coordinates, using the NREL SPA algorithm (see ...">sun_nrelApp2()</a> to obtain the Sun's position, after having called <a class="el" href="sky0_8h.html#a7a264cd6849a45a5edc1c660c8b76aa6" title="Calculates the nutation in longitude and obliquity, according to the algorithm set out in the NREL SP...">sky0_nutationSpa()</a> to obtain the necessary nutation terms. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">j2kTT_cy</td><td>Julian centuries since J2000.0, TT timescale </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pos</td><td>Timestamped structure containing position data and the equation of the equinoxes</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>When to call this function</dt><dd>Because this function is computationally intensive, you may wish to limit your use of this function.<ul>
<li>if you want the Sun's position at multiple sites simultaneously at a single time, call this function, then follow it with a call to routine <a class="el" href="sky0_8h.html#a420b9af8dd92d7151d5ccc253c417954" title="Convert a position in geocentric apparent coordinates to geocentric coordinates in the Terrestrial In...">sky0_appToTirs()</a>, and then make a separate call to <a class="el" href="sky_8h.html#a0797b1e268ac7cc5b052c0623883eb74" title="Transform a coordinate vector from the Terrestrial Intermediate Reference System to topocentric Az/El...">sky_siteTirsToTopo()</a> for each of one those sites.</li>
<li>if you want the Sun's position at one or more sites at closely spaced times (e.g. for tracking the Sun), pass this function to the <a class="el" href="skyfast_8h.html#ac22205943c218e19d4313fc71dda43d4" title="Initialise those items that take a long time to calculate, but which do not need to be recalculated f...">skyfast_init()</a> function. <a class="el" href="skyfast_8h.html#ac22205943c218e19d4313fc71dda43d4" title="Initialise those items that take a long time to calculate, but which do not need to be recalculated f...">skyfast_init()</a> will call it for you several times, to fully calculate positions that will be saved and used later for interpolation by the <a class="el" href="skyfast_8h.html#afb9144e153624a3bf899af40eca07ac0" title="Get the best approximation to the celestial object&#39;s apparent coordinates and distance,...">skyfast_getApprox()</a> function for tracking. </li>
</ul>
</dd></dl>
<dl class="section user"><dt></dt><dd><em>Alternatives:</em> <ul>
<li>If you want the Sun's position at a single site only at a single time, call <a class="el" href="sun_8h.html#ac555d348d21360e65ff644212d7f84b4" title="Calls sun_nrelApparent() to calculate the Sun&#39;s position in apparent coordinates using the NREL Sun P...">sun_nrelTopocentric()</a> instead, and it will call this function for you.</li>
<li>If you want the Sun's position at a single site for more than one time but the times are spaced more than a few hours apart, once again call <a class="el" href="sun_8h.html#ac555d348d21360e65ff644212d7f84b4" title="Calls sun_nrelApparent() to calculate the Sun&#39;s position in apparent coordinates using the NREL Sun P...">sun_nrelTopocentric()</a> instead.</li>
<li>If you want to track the sun, call <a class="el" href="skyfast_8h.html#afb9144e153624a3bf899af40eca07ac0" title="Get the best approximation to the celestial object&#39;s apparent coordinates and distance,...">skyfast_getApprox()</a> instead. But this requires you to set up interpolation first with function <a class="el" href="skyfast_8h.html#ac22205943c218e19d4313fc71dda43d4" title="Initialise those items that take a long time to calculate, but which do not need to be recalculated f...">skyfast_init()</a> (and this function), as described above.</li>
</ul>
</dd></dl>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="sun_8c_source.html#l00211">211</a> of file <a class="el" href="sun_8c_source.html">sun.c</a>.</p>

</div>
</div>
<a id="ac555d348d21360e65ff644212d7f84b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac555d348d21360e65ff644212d7f84b4">&#9670;&nbsp;</a></span>sun_nrelTopocentric()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sun_nrelTopocentric </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>j2kUtc_d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_sky___delta_ts.html">Sky_DeltaTs</a> *&#160;</td>
          <td class="paramname"><em>deltas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_sky___site_prop.html">Sky_SiteProp</a> *&#160;</td>
          <td class="paramname"><em>site</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_sky___site_horizon.html">Sky_SiteHorizon</a> *&#160;</td>
          <td class="paramname"><em>topo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls <a class="el" href="sun_8h.html#a257ebc73aa83eef26448d451eeb086da" title="Calculate the Sun&#39;s position as a unit vector and a distance, in apparent coordinates.">sun_nrelApparent()</a> to calculate the Sun's position in apparent coordinates using the NREL Sun Position Algorithm, and then converts this to topocentric horizon coordinates at the specified site. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">j2kUtc_d</td><td>UTC time in "J2KD" form - i.e days since J2000.0 (= JD - 2 451 545.0) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">deltas</td><td>Delta T values, as set by the <a class="el" href="sky_8h.html#abf770ba7cb996e73f59f41f24b172e3a" title="Set up the various delta time values for use in ongoing calculations.">sky_initTime()</a> (or <a class="el" href="sky_8h.html#a15ad9a782e54212cb22bd0658b6541a0" title="Initialise delta times with simple default values.">sky_initTimeSimple()</a> or <a class="el" href="sky_8h.html#a4295dc6df66f02c4def3160782a06902" title="Set up the various delta time values for use in ongoing calculations.">sky_initTimeDetailed()</a>) routines </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">site</td><td>Properties of the observing site, particularly its geometric location on the surface of the Earth, as set by the <a class="el" href="sky_8h.html#a185862b772bcb6ef6eebf5cb33de09a6" title="Initialise the site structure by calculating those site-related values that do not change with time.">sky_setSiteLocation()</a> function (or <a class="el" href="sky_8h.html#a031a736d11ac57f7bf73cb8f68bb5aec" title="Alternative initialisation function to sky_setSiteLocation().">sky_setSiteLoc2()</a>) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">topo</td><td>Topocentric position, in both rectangular (unit vector) form, and as Azimuth and Elevation (altitude) angles</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>When to call this function</dt><dd>Use this function if you are calculating the Sun topocentric position once, for a single site. But if you are going to be calculating it repeatedly, or for multiple sites, use of this function will cause you to perform a great many needless recalculations. Use <a class="el" href="skyfast_8h.html#afb9144e153624a3bf899af40eca07ac0" title="Get the best approximation to the celestial object&#39;s apparent coordinates and distance,...">skyfast_getApprox()</a>, followed by <a class="el" href="sky0_8h.html#a420b9af8dd92d7151d5ccc253c417954" title="Convert a position in geocentric apparent coordinates to geocentric coordinates in the Terrestrial In...">sky0_appToTirs()</a> and <a class="el" href="sky_8h.html#a0797b1e268ac7cc5b052c0623883eb74" title="Transform a coordinate vector from the Terrestrial Intermediate Reference System to topocentric Az/El...">sky_siteTirsToTopo()</a> instead.</dd></dl>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="sun_8c_source.html#l00266">266</a> of file <a class="el" href="sun_8c_source.html">sun.c</a>.</p>

</div>
</div>
<a id="a42caefa9705e53013331f3f3ec683de6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42caefa9705e53013331f3f3ec683de6">&#9670;&nbsp;</a></span>sun_solarNoon()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double sun_solarNoon </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>year</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>month</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>day</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_sky___delta_ts.html">Sky_DeltaTs</a> *&#160;</td>
          <td class="paramname"><em>deltas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_sky___site_prop.html">Sky_SiteProp</a> *&#160;</td>
          <td class="paramname"><em>site</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_sky___site_horizon.html">Sky_SiteHorizon</a> *&#160;</td>
          <td class="paramname"><em>topo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Routine to calculate the time of solar noon (Sun transit) for the day specified by <em>year</em>, <em>month</em> and <em>day</em>. </p>
<p>This function uses the NREL SPA algorithm of <a class="el" href="sun_8h.html#ac555d348d21360e65ff644212d7f84b4" title="Calls sun_nrelApparent() to calculate the Sun&#39;s position in apparent coordinates using the NREL Sun P...">sun_nrelTopocentric()</a> to calculate the Sun's position. </p><dl class="section return"><dt>Returns</dt><dd>Solar noon for the day given in <em>year</em>, <em>month</em> and <em>day</em> (returned as a J2KD date (= JD - 2 451 545.0), UTC timescale). To view this as a local date and time, add this value to <em>site-&gt;timezone_d</em> and pass the result to function <a class="el" href="sky_8h.html#a6afa64839aaee5925d90c013e8eaa0b2" title="This procedure converts the integral part of the date in &quot;J2KD&quot; form to a calendar date and the fract...">sky_j2kdToCalTime()</a>. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">year,month,day</td><td>Date for which solar noon is desired </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">deltas</td><td>Delta T values, as set by the <a class="el" href="sky_8h.html#abf770ba7cb996e73f59f41f24b172e3a" title="Set up the various delta time values for use in ongoing calculations.">sky_initTime()</a> (or <a class="el" href="sky_8h.html#a15ad9a782e54212cb22bd0658b6541a0" title="Initialise delta times with simple default values.">sky_initTimeSimple()</a> or <a class="el" href="sky_8h.html#a4295dc6df66f02c4def3160782a06902" title="Set up the various delta time values for use in ongoing calculations.">sky_initTimeDetailed()</a>) routines </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">site</td><td>Properties of the observing site, particularly its geometric location on the surface of the Earth and its time zone, as set by the <a class="el" href="sky_8h.html#a185862b772bcb6ef6eebf5cb33de09a6" title="Initialise the site structure by calculating those site-related values that do not change with time.">sky_setSiteLocation()</a> function (or <a class="el" href="sky_8h.html#a031a736d11ac57f7bf73cb8f68bb5aec" title="Alternative initialisation function to sky_setSiteLocation().">sky_setSiteLoc2()</a>) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">topo</td><td><b>Optional</b>. Topocentric position of the Sun at transit, in both rectangular (unit vector) form, and as Azimuth and Elevation (altitude) angles. If you are not interested in these values, you can pass NULL to this parameter.</td></tr>
  </table>
  </dd>
</dl>
<p>This routine uses an iterative approach. Two iterations is all that is needed to get a result within about 0.05 seconds.</p>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="sun_8c_source.html#l00310">310</a> of file <a class="el" href="sun_8c_source.html">sun.c</a>.</p>

</div>
</div>
<a id="a2b95525b0966c30a2002fae909e6ebc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b95525b0966c30a2002fae909e6ebc5">&#9670;&nbsp;</a></span>sun_riseSet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double sun_riseSet </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>year</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>month</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>day</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>getSunrise</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_sky___delta_ts.html">Sky_DeltaTs</a> *&#160;</td>
          <td class="paramname"><em>deltas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_sky___site_prop.html">Sky_SiteProp</a> *&#160;</td>
          <td class="paramname"><em>site</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_sky___site_horizon.html">Sky_SiteHorizon</a> *&#160;</td>
          <td class="paramname"><em>topo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Routine to calculate the time of sunrise or sunset for the day specified by <em>year</em>, <em>month</em> and <em>day</em>. </p>
<p>This function uses the NREL SPA algorithm of <a class="el" href="sun_8h.html#ac555d348d21360e65ff644212d7f84b4" title="Calls sun_nrelApparent() to calculate the Sun&#39;s position in apparent coordinates using the NREL Sun P...">sun_nrelTopocentric()</a> to calculate the Sun's position. </p><dl class="section return"><dt>Returns</dt><dd>Sunrise (or sunset) time for the day given in <em>year</em>, <em>month</em> and <em>day</em> (returned as a J2KD date (= JD - 2 451 545.0), UTC timescale). To view this as a local date and time, add this value to <em>site-&gt;timezone_d</em> and pass the result to function <a class="el" href="sky_8h.html#a6afa64839aaee5925d90c013e8eaa0b2" title="This procedure converts the integral part of the date in &quot;J2KD&quot; form to a calendar date and the fract...">sky_j2kdToCalTime()</a>. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">year,month,day</td><td>Date for which sunrise or sunset time is desired </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">getSunrise</td><td>If true, get sunrise time. If false, get sunset time </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">deltas</td><td>Delta T values, as set by the <a class="el" href="sky_8h.html#abf770ba7cb996e73f59f41f24b172e3a" title="Set up the various delta time values for use in ongoing calculations.">sky_initTime()</a> (or <a class="el" href="sky_8h.html#a15ad9a782e54212cb22bd0658b6541a0" title="Initialise delta times with simple default values.">sky_initTimeSimple()</a> or <a class="el" href="sky_8h.html#a4295dc6df66f02c4def3160782a06902" title="Set up the various delta time values for use in ongoing calculations.">sky_initTimeDetailed()</a>) routines </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">site</td><td>Properties of the observing site, particularly its geometric location on the surface of the Earth and its time zone, as set by the <a class="el" href="sky_8h.html#a185862b772bcb6ef6eebf5cb33de09a6" title="Initialise the site structure by calculating those site-related values that do not change with time.">sky_setSiteLocation()</a> function (or <a class="el" href="sky_8h.html#a031a736d11ac57f7bf73cb8f68bb5aec" title="Alternative initialisation function to sky_setSiteLocation().">sky_setSiteLoc2()</a>) and <a class="el" href="sky_8h.html#a982a0d853512a67d9e2177845e605dc4" title="Set the time zone offset for this site.">sky_setSiteTimeZone()</a>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">topo</td><td><b>Optional</b>. Topocentric position of the Sun at rise or set, in both rectangular (unit vector) form, and as Azimuth and Elevation (altitude) angles. If you are not interested in these values, you can pass NULL to this parameter.</td></tr>
  </table>
  </dd>
</dl>
<p>This routine uses an iterative approach. It does two iterations.</p>
<dl class="section note"><dt>Note</dt><dd>If the Sun does not rise (or set) on the specified day at the specified latitude, this function will return 0.0 </dd>
<dd>
This routine assumes a standard refraction at the horizon of 34 arcminutes. Although this is typical of sunrise/sunset calculations, it is not necessarily the actual refraction that will occur at any given place or time. So the results should be considered approximate. Don't expect it to be be any better than the nearest minute to the time at which the sun appears or disappears.</dd></dl>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="sun_8c_source.html#l00363">363</a> of file <a class="el" href="sun_8c_source.html">sun.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="sun_8h.html">sun.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
