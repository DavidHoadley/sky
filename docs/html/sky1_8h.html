<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Sun position: sky1.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Sun position
   &#160;<span id="projectnumber">0.1.9-1</span>
   </div>
   <div id="projectbrief">Sun position algorithm</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('sky1_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">sky1.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="sky1_8h.html" title="sky1.h - astronomical coordinate conversion routines, IAU 1980">sky1.h</a> - astronomical coordinate conversion routines, IAU 1980  
<a href="#details">More...</a></p>

<p><a href="sky1_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_sky1___prec1976.html">Sky1_Prec1976</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Precession angles.  <a href="struct_sky1___prec1976.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_sky1___nut1980.html">Sky1_Nut1980</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Nutation angles and obliquity.  <a href="struct_sky1___nut1980.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af1ae1a3711d82cba97bd4d54f812a86e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sky1_8h.html#af1ae1a3711d82cba97bd4d54f812a86e">sky1_frameBiasFK5</a> (<a class="el" href="struct_v3_d___matrix.html">V3D_Matrix</a> *biasM)</td></tr>
<tr class="memdesc:af1ae1a3711d82cba97bd4d54f812a86e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create the frame bias matrix from the IAU 2000 precession-nutation model.  <a href="sky1_8h.html#af1ae1a3711d82cba97bd4d54f812a86e">More...</a><br /></td></tr>
<tr class="separator:af1ae1a3711d82cba97bd4d54f812a86e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a443dfb8c35b2c9a7ed11e4f4df14e7df"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sky1_8h.html#a443dfb8c35b2c9a7ed11e4f4df14e7df">sky1_precessionIAU1976</a> (double t0, double t1, <a class="el" href="struct_sky1___prec1976.html">Sky1_Prec1976</a> *terms)</td></tr>
<tr class="memdesc:a443dfb8c35b2c9a7ed11e4f4df14e7df"><td class="mdescLeft">&#160;</td><td class="mdescRight">This procedure calculates the equatorial precession parameters ζ, z, and θ which represent the rotation required to transform the FK5 equatorial reference system of Julian epoch t0 to that of Julian epoch t1, according to the IAU 1976 precession constants.  <a href="sky1_8h.html#a443dfb8c35b2c9a7ed11e4f4df14e7df">More...</a><br /></td></tr>
<tr class="separator:a443dfb8c35b2c9a7ed11e4f4df14e7df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac92f2acd0623795c195cbf848458c662"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sky1_8h.html#ac92f2acd0623795c195cbf848458c662">sky1_createPrec1976Matrix</a> (const <a class="el" href="struct_sky1___prec1976.html">Sky1_Prec1976</a> *terms, <a class="el" href="struct_v3_d___matrix.html">V3D_Matrix</a> *precM)</td></tr>
<tr class="memdesc:ac92f2acd0623795c195cbf848458c662"><td class="mdescLeft">&#160;</td><td class="mdescRight">This routine calculates the precession matrix, based on angles ζ, z, and θ.  <a href="sky1_8h.html#ac92f2acd0623795c195cbf848458c662">More...</a><br /></td></tr>
<tr class="separator:ac92f2acd0623795c195cbf848458c662"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61813485e959ed0208086d946e33ad4c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sky1_8h.html#a61813485e959ed0208086d946e33ad4c">sky1_nutationIAU1980</a> (double t_cy, int precision, <a class="el" href="struct_sky1___nut1980.html">Sky1_Nut1980</a> *nut)</td></tr>
<tr class="memdesc:a61813485e959ed0208086d946e33ad4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the nutation in longitude and obliquity, according to the IAU 1980 Nutation Theory.  <a href="sky1_8h.html#a61813485e959ed0208086d946e33ad4c">More...</a><br /></td></tr>
<tr class="separator:a61813485e959ed0208086d946e33ad4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a956ebf3c1277943e770093830777ca0d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sky1_8h.html#a956ebf3c1277943e770093830777ca0d">sky1_epsilon1980</a> (double t_cy, <a class="el" href="struct_sky1___nut1980.html">Sky1_Nut1980</a> *nut)</td></tr>
<tr class="memdesc:a956ebf3c1277943e770093830777ca0d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the obliquity of the ecliptic and the equation of the equinoxes.  <a href="sky1_8h.html#a956ebf3c1277943e770093830777ca0d">More...</a><br /></td></tr>
<tr class="separator:a956ebf3c1277943e770093830777ca0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13ed20ef8965385a267f14bb1965539f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sky1_8h.html#a13ed20ef8965385a267f14bb1965539f">sky1_createNut1980Matrix</a> (const <a class="el" href="struct_sky1___nut1980.html">Sky1_Nut1980</a> *nut, <a class="el" href="struct_v3_d___matrix.html">V3D_Matrix</a> *nutM)</td></tr>
<tr class="memdesc:a13ed20ef8965385a267f14bb1965539f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This routine calculates the Nutation matrix, using the nutation in longitude, the nutation in obliquity, and the mean obliquity of the equator.  <a href="sky1_8h.html#a13ed20ef8965385a267f14bb1965539f">More...</a><br /></td></tr>
<tr class="separator:a13ed20ef8965385a267f14bb1965539f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace44a5ea8db1f9ee75c14fd67daaa45e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sky1_8h.html#ace44a5ea8db1f9ee75c14fd67daaa45e">sky1_createNPmatrix</a> (double t0_cy, double t1_cy, int precision, <a class="el" href="struct_v3_d___matrix.html">V3D_Matrix</a> *npM)</td></tr>
<tr class="memdesc:ace44a5ea8db1f9ee75c14fd67daaa45e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Call the various precession and nutation routines in this module to create a combined precession and nutation rotation matrix, suitable for converting a celestial object's coordinates from mean place at epoch <em>t0_cy</em> to apparent coordinates at epoch <em>t1_cy</em>.  <a href="sky1_8h.html#ace44a5ea8db1f9ee75c14fd67daaa45e">More...</a><br /></td></tr>
<tr class="separator:ace44a5ea8db1f9ee75c14fd67daaa45e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf4ec009b45c88bb180898104cb7302a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sky1_8h.html#adf4ec009b45c88bb180898104cb7302a">sky1_gmSiderealTimeIAU1982</a> (double du)</td></tr>
<tr class="memdesc:adf4ec009b45c88bb180898104cb7302a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the Greenwich mean sidereal time.  <a href="sky1_8h.html#adf4ec009b45c88bb180898104cb7302a">More...</a><br /></td></tr>
<tr class="separator:adf4ec009b45c88bb180898104cb7302a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5023b9fbc0669c62f1422e13e5a6df1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sky1_8h.html#aa5023b9fbc0669c62f1422e13e5a6df1">sky1_appToTirs</a> (const <a class="el" href="struct_v3_d___vector.html">V3D_Vector</a> *appV, double j2kUT1_d, double eqEq_rad, <a class="el" href="struct_v3_d___vector.html">V3D_Vector</a> *terInterV)</td></tr>
<tr class="memdesc:aa5023b9fbc0669c62f1422e13e5a6df1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a position in geocentric apparent coordinates to geocentric coordinates in the Terrestrial Intermediate Reference System.  <a href="sky1_8h.html#aa5023b9fbc0669c62f1422e13e5a6df1">More...</a><br /></td></tr>
<tr class="separator:aa5023b9fbc0669c62f1422e13e5a6df1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="sky1_8h.html" title="sky1.h - astronomical coordinate conversion routines, IAU 1980">sky1.h</a> - astronomical coordinate conversion routines, IAU 1980 </p>
<dl class="section author"><dt>Author</dt><dd>David Hoadley</dd></dl>
<p>This is one of three alternative modules: <a class="el" href="sky0_8h.html" title="sky0.h - astronomical coordinate conversion for NREL Sun Position Algorithm">sky0.h</a> / <a class="el" href="sky0_8c_source.html">sky0.c</a>, <a class="el" href="sky1_8h.html" title="sky1.h - astronomical coordinate conversion routines, IAU 1980">sky1.h</a> / <a class="el" href="sky1_8c_source.html">sky1.c</a> and sky2.h / sky2.c. They contain routines for transforming astronomical positions from frame to another: precession, nutation, sidereal time etc. and they reflect changes in the International Astronomical Union's precession and nutation theory. The differences are:</p><ul>
<li><a class="el" href="sky0_8h.html" title="sky0.h - astronomical coordinate conversion for NREL Sun Position Algorithm">sky0.h</a> / <a class="el" href="sky0_8c_source.html">sky0.c</a>: nutation, obliquity and sidereal time routines from the NREL Solar Position Algorithm document. These are based on the IAU 1980 nutation theory.</li>
<li><a class="el" href="sky1_8h.html" title="sky1.h - astronomical coordinate conversion routines, IAU 1980">sky1.h</a> / <a class="el" href="sky1_8c_source.html">sky1.c</a>: precession, nutation and their associated rotation matrices, obliquity and sidereal time. These are the IAU 1980 precession and nutation theory.</li>
<li>sky2.h / sky2.c: precession, nutation and their associated rotation matrices, obliquity and sidereal time. These are the newer IAU 2000 precession and nutation theory.</li>
</ul>
<p>This module (<a class="el" href="sky1_8h.html" title="sky1.h - astronomical coordinate conversion routines, IAU 1980">sky1.h</a> / <a class="el" href="sky1_8c_source.html">sky1.c</a>) contains precession and nutation routines. The precession routine uses the IAU 1976 algorithm. The nutation routine uses the IAU 1980 algorithm.</p>
<hr  />
 
<p class="definition">Definition in file <a class="el" href="sky1_8h_source.html">sky1.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="af1ae1a3711d82cba97bd4d54f812a86e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1ae1a3711d82cba97bd4d54f812a86e">&#9670;&nbsp;</a></span>sky1_frameBiasFK5()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sky1_frameBiasFK5 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_v3_d___matrix.html">V3D_Matrix</a> *&#160;</td>
          <td class="paramname"><em>biasM</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create the frame bias matrix from the IAU 2000 precession-nutation model. </p>
<p>This matrix is used to convert coordinates from the Geocentric Celestial Reference System (GCRS) to FK5 reference system. (Although anything to do with the ICRS/GCRS is related to the IAU2000+ precession-nutation theory, this routine is included here to allow ICRS star catalogue positions to be converted to apparent coordinates using the IAU1980 precession-nutation theory, which is quite good enough for tracking. It is not good enough for astrometry, but it will get us to better than within an arcsecond of our desired apparent position). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">biasM</td><td>Frame bias matrix <b>B</b> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Reference:</dt><dd><em>Astronomical Almanac</em> 2007, page B28</dd></dl>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="sky1_8c_source.html#l00339">339</a> of file <a class="el" href="sky1_8c_source.html">sky1.c</a>.</p>

</div>
</div>
<a id="a443dfb8c35b2c9a7ed11e4f4df14e7df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a443dfb8c35b2c9a7ed11e4f4df14e7df">&#9670;&nbsp;</a></span>sky1_precessionIAU1976()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sky1_precessionIAU1976 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t0_cy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t1_cy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_sky1___prec1976.html">Sky1_Prec1976</a> *&#160;</td>
          <td class="paramname"><em>terms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This procedure calculates the equatorial precession parameters ζ, z, and θ which represent the rotation required to transform the FK5 equatorial reference system of Julian epoch t0 to that of Julian epoch t1, according to the IAU 1976 precession constants. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t0_cy</td><td>Julian centuries since J2000.0 of initial epoch, TT timescale </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t1_cy</td><td>Julian centuries since J2000.0 of final epoch, TT timescale </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">terms</td><td>The three precession angles ζ, z, θ.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>References:</dt><dd>Lieske,J.H., <em>Astron. Astrophys</em>, Vol 73, pp282-284, 1979<br  />
 <em>Supplement to The Astronomical Almanac 1984</em>, HMNAO, ppS18-19</dd></dl>
<dl class="section user"><dt>When to call this function</dt><dd>It is quite likely that you will not need to call this function directly. If you are tracking a celestial object, using <a class="el" href="star_8h.html#a65152f6caf32ee5c581fe7e54994b952" title="Calculate the position of the currently selected star (or other object outside the solar system) as a...">star_getApparent()</a> or <a class="el" href="star_8h.html#a18316f54644bd7ded2108492232be9d3" title="Calls star_getApparent() to calculate the star&#39;s position in apparent coordinates,...">star_getTopocentric()</a> or calling <a class="el" href="planet_8h.html#a96b2ba1bce82bbd875d0740576a24262" title="Calculate the position of the currently selected planet as a unit vector and a distance,...">planet_getApparent()</a> or <a class="el" href="planet_8h.html#ae551d337a5eb752a7e5e56417392e923" title="Calls planet_getApparent() to calculate the planet&#39;s position in apparent coordinates,...">planet_getTopocentric()</a>, they will call this routine for you. Likewise, if you are tracking the object using the skyfast module, the call to <a class="el" href="skyfast_8h.html#ac22205943c218e19d4313fc71dda43d4" title="Initialise those items that take a long time to calculate, but which do not need to be recalculated f...">skyfast_init()</a> will call either <a class="el" href="star_8h.html#a65152f6caf32ee5c581fe7e54994b952" title="Calculate the position of the currently selected star (or other object outside the solar system) as a...">star_getApparent()</a> or <a class="el" href="planet_8h.html#a96b2ba1bce82bbd875d0740576a24262" title="Calculate the position of the currently selected planet as a unit vector and a distance,...">planet_getApparent()</a>, and therefore call this routine for you. </dd></dl>
<dl class="section user"><dt></dt><dd>The values calculated by this routine change only slowly. So if you are calling it yourself, you can call it infrequently. Intervals of up to an hour between calls will not introduce much error. This function is also called by <a class="el" href="sky1_8h.html#ace44a5ea8db1f9ee75c14fd67daaa45e" title="Call the various precession and nutation routines in this module to create a combined precession and ...">sky1_createNPmatrix()</a>.</dd></dl>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="sky1_8c_source.html#l00375">375</a> of file <a class="el" href="sky1_8c_source.html">sky1.c</a>.</p>

</div>
</div>
<a id="ac92f2acd0623795c195cbf848458c662"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac92f2acd0623795c195cbf848458c662">&#9670;&nbsp;</a></span>sky1_createPrec1976Matrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sky1_createPrec1976Matrix </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_sky1___prec1976.html">Sky1_Prec1976</a> *&#160;</td>
          <td class="paramname"><em>terms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_v3_d___matrix.html">V3D_Matrix</a> *&#160;</td>
          <td class="paramname"><em>precM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This routine calculates the precession matrix, based on angles ζ, z, and θ. </p>
<p><em>precM</em> is the combined orthogonal rotation matrix <b>P</b>, required for rigorous precession transformations using rectangular coordinates and matrix methods: V1 = P * V0 It appears to be calculated from<br  />
 <b>P</b> = R3(-z) × R2(θ) × R3(-ζ) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">terms</td><td>The three precession angles ζ, z, θ, as returned by <a class="el" href="sky1_8h.html#a443dfb8c35b2c9a7ed11e4f4df14e7df" title="This procedure calculates the equatorial precession parameters ζ, z, and θ which represent the rotati...">sky1_precessionIAU1976()</a> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">precM</td><td>Precession rotation matrix</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>References:</dt><dd>Lieske,J.H., <em>Astron. Astrophys</em>, Vol 73, pp282-284, 1979<br  />
 <em>Supplement to The Astronomical Almanac 1984</em>, HMNAO, ppS18-19</dd></dl>
<dl class="section user"><dt>When to call this function</dt><dd>Call this function after new values of ζ, z and θ have been calculated by routine <a class="el" href="sky1_8h.html#a443dfb8c35b2c9a7ed11e4f4df14e7df" title="This procedure calculates the equatorial precession parameters ζ, z, and θ which represent the rotati...">sky1_precessionIAU1976()</a>. So, again, it need only be called infrequently. But as mentioned for that function, it is quite likely that you will not need to call this function directly. Any of the functions <a class="el" href="sky1_8h.html#ace44a5ea8db1f9ee75c14fd67daaa45e" title="Call the various precession and nutation routines in this module to create a combined precession and ...">sky1_createNPmatrix()</a>, <a class="el" href="star_8h.html#a65152f6caf32ee5c581fe7e54994b952" title="Calculate the position of the currently selected star (or other object outside the solar system) as a...">star_getApparent()</a>, <a class="el" href="star_8h.html#a18316f54644bd7ded2108492232be9d3" title="Calls star_getApparent() to calculate the star&#39;s position in apparent coordinates,...">star_getTopocentric()</a>, <a class="el" href="planet_8h.html#a96b2ba1bce82bbd875d0740576a24262" title="Calculate the position of the currently selected planet as a unit vector and a distance,...">planet_getApparent()</a> or <a class="el" href="planet_8h.html#ae551d337a5eb752a7e5e56417392e923" title="Calls planet_getApparent() to calculate the planet&#39;s position in apparent coordinates,...">planet_getTopocentric()</a> will call this routine for you.</dd></dl>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="sky1_8c_source.html#l00437">437</a> of file <a class="el" href="sky1_8c_source.html">sky1.c</a>.</p>

</div>
</div>
<a id="a61813485e959ed0208086d946e33ad4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61813485e959ed0208086d946e33ad4c">&#9670;&nbsp;</a></span>sky1_nutationIAU1980()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sky1_nutationIAU1980 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t_cy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>precision</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_sky1___nut1980.html">Sky1_Nut1980</a> *&#160;</td>
          <td class="paramname"><em>nut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the nutation in longitude and obliquity, according to the IAU 1980 Nutation Theory. </p>
<p>Calculates first the fundamental nutation arguments, and then a series of terms. There are 106 terms in the series, but fewer may be selected for faster execution. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t_cy</td><td>Julian centuries since J2000.0, TT timescale </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">precision</td><td>How much precision do you want? Valid range [0, 4]. Values outside this range will be clamped to the range.<ul>
<li>0 = full precision, use full 106-term series</li>
<li>1 = ignore terms &lt; 0.2 milliarcseconds. 72-term series</li>
<li>2 = ignore terms &lt; 0.3 milliarcseconds. 63-term series</li>
<li>3 = ignore terms &lt; 0.5 milliarcseconds. 49-term series</li>
<li>4 = ignore terms &lt; 1.0 milliarcseconds. 35-term series </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nut</td><td>field <em>nut-&gt;dPsi_rad</em> - Nutation in longitude Δψ (radian)<br  />
 field <em>nut-&gt;dEps_rad</em> - Nutation in obliquity Δε (radian)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>References:</dt><dd>Final report of the IAU Working Group on Nutation, chairman P.K.Seidelmann, 1980, published in <em>Celestial Mechanics</em>, Vol 27, pp79-106, 1982.<br  />
 Kaplan,G.H. <em>USNO circular no. 163</em>, pp A3-6, 1981.<br  />
 <em>Supplement to the Astronomical Almanac</em> 1984.<br  />
 The form of the data tables was inspired by, and extended from, Reda, I. and Andreas, A. (2003), "Solar Position Algorithm
        for Solar Radiation Applications", National Renewable Energy Laboratory, NREL publication no. NREL/TP-560-34302.</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>With precision = 0, exact agreement with tabulated values in the <em>Astronomical Almanac</em> 1987 pages B24 - B31 was found (to 3 decimal places, as tabulated in the Almanac). Likewise for the 1990 edition pages B24 - B31. But this IAU 1980 theory has been superseded by the more accurate IAU 2000 theory. This is evident when comparing outputs with the tabulated values in the 2007 Almanac, pages B34 - B41 (to 4 decimal places). There are differences of several milliarcseconds.</li>
<li>With precision = 1, differences up to 1.0 milliarcsecond were seen compared to the precision = 0 values during testing.</li>
<li>With precision = 2, differences up to 1.2 milliarcseconds were seen</li>
<li>With precision = 3, differences up to 1.5 milliarcseconds were seen</li>
<li><p class="startli">With precision = 4, differences of up to 5 milliarcseconds were seen.</p>
<p class="startli">For tracking purposes, these are still very small. The testing was not exhaustive, so take this as a rough guide only.</p>
</li>
</ul>
</dd></dl>
<dl class="section user"><dt>When to call this function</dt><dd>It is quite likely that you will not need to call this function directly. If you are tracking a celestial object, using <a class="el" href="star_8h.html#a65152f6caf32ee5c581fe7e54994b952" title="Calculate the position of the currently selected star (or other object outside the solar system) as a...">star_getApparent()</a> or <a class="el" href="star_8h.html#a18316f54644bd7ded2108492232be9d3" title="Calls star_getApparent() to calculate the star&#39;s position in apparent coordinates,...">star_getTopocentric()</a> or calling <a class="el" href="planet_8h.html#a96b2ba1bce82bbd875d0740576a24262" title="Calculate the position of the currently selected planet as a unit vector and a distance,...">planet_getApparent()</a> or <a class="el" href="planet_8h.html#ae551d337a5eb752a7e5e56417392e923" title="Calls planet_getApparent() to calculate the planet&#39;s position in apparent coordinates,...">planet_getTopocentric()</a>, they will call this routine for you. Likewise, if you are tracking the object using the skyfast module, the call to <a class="el" href="skyfast_8h.html#ac22205943c218e19d4313fc71dda43d4" title="Initialise those items that take a long time to calculate, but which do not need to be recalculated f...">skyfast_init()</a> will call either <a class="el" href="star_8h.html#a65152f6caf32ee5c581fe7e54994b952" title="Calculate the position of the currently selected star (or other object outside the solar system) as a...">star_getApparent()</a> or <a class="el" href="planet_8h.html#a96b2ba1bce82bbd875d0740576a24262" title="Calculate the position of the currently selected planet as a unit vector and a distance,...">planet_getApparent()</a>, and therefore call this routine for you. </dd></dl>
<dl class="section user"><dt></dt><dd>The values calculated by this routine change only slowly. So if you are calling it yourself, you can call it infrequently. Intervals of up to an hour between calls will not introduce much error. This function is also called by <a class="el" href="sky1_8h.html#ace44a5ea8db1f9ee75c14fd67daaa45e" title="Call the various precession and nutation routines in this module to create a combined precession and ...">sky1_createNPmatrix()</a>.</dd></dl>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="sky1_8c_source.html#l00481">481</a> of file <a class="el" href="sky1_8c_source.html">sky1.c</a>.</p>

</div>
</div>
<a id="a956ebf3c1277943e770093830777ca0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a956ebf3c1277943e770093830777ca0d">&#9670;&nbsp;</a></span>sky1_epsilon1980()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sky1_epsilon1980 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t_cy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_sky1___nut1980.html">Sky1_Nut1980</a> *&#160;</td>
          <td class="paramname"><em>nut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the obliquity of the ecliptic and the equation of the equinoxes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t_cy</td><td>Julian centuries since J2000.0, TT timescale </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nut</td><td>[in] field <em>nut-&gt;dPsi_rad</em> - Nutation in longitude Δψ, as returned by function <a class="el" href="sky1_8h.html#a61813485e959ed0208086d946e33ad4c" title="Calculates the nutation in longitude and obliquity, according to the IAU 1980 Nutation Theory.">sky1_nutationIAU1980()</a> (radian)<br  />
 [in] field <em>nut-&gt;dEps_rad</em> - Nutation in obliquity Δε, as returned by function <a class="el" href="sky1_8h.html#a61813485e959ed0208086d946e33ad4c" title="Calculates the nutation in longitude and obliquity, according to the IAU 1980 Nutation Theory.">sky1_nutationIAU1980()</a> (radian)<br  />
 [out] field <em>nut-&gt;eps0_rad</em> - Mean obliquity of the ecliptic ε0 (radian)<br  />
 [out] field <em>nut-&gt;eqEq_rad</em> - Equation of the equinoxes = Δψ * cos(ε0 + Δε) (radian) Note: not seconds </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>References</dt><dd><em>Astronomical Almanac</em> 1987 page B18<br  />
 International Astronomical Union, Standards of Fundamental Astronomy software collection, release 2017-04-20. <a href="http://www.iausofa.org">http://www.iausofa.org</a> routine <code>iauObl80()</code> </dd></dl>
<dl class="section user"><dt>When to call this function</dt><dd>Call this function after new values of Δψ, and Δε have been calculated by routine <a class="el" href="sky1_8h.html#a61813485e959ed0208086d946e33ad4c" title="Calculates the nutation in longitude and obliquity, according to the IAU 1980 Nutation Theory.">sky1_nutationIAU1980()</a>. So, again, it need only be called infrequently. But as mentioned for that function, it is quite likely that you will not need to call this function directly. Any of the functions <a class="el" href="sky1_8h.html#ace44a5ea8db1f9ee75c14fd67daaa45e" title="Call the various precession and nutation routines in this module to create a combined precession and ...">sky1_createNPmatrix()</a>, <a class="el" href="star_8h.html#a65152f6caf32ee5c581fe7e54994b952" title="Calculate the position of the currently selected star (or other object outside the solar system) as a...">star_getApparent()</a>, <a class="el" href="star_8h.html#a18316f54644bd7ded2108492232be9d3" title="Calls star_getApparent() to calculate the star&#39;s position in apparent coordinates,...">star_getTopocentric()</a>, <a class="el" href="planet_8h.html#a96b2ba1bce82bbd875d0740576a24262" title="Calculate the position of the currently selected planet as a unit vector and a distance,...">planet_getApparent()</a> or <a class="el" href="planet_8h.html#ae551d337a5eb752a7e5e56417392e923" title="Calls planet_getApparent() to calculate the planet&#39;s position in apparent coordinates,...">planet_getTopocentric()</a> will call this routine for you.</dd></dl>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="sky1_8c_source.html#l00631">631</a> of file <a class="el" href="sky1_8c_source.html">sky1.c</a>.</p>

</div>
</div>
<a id="a13ed20ef8965385a267f14bb1965539f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13ed20ef8965385a267f14bb1965539f">&#9670;&nbsp;</a></span>sky1_createNut1980Matrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sky1_createNut1980Matrix </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_sky1___nut1980.html">Sky1_Nut1980</a> *&#160;</td>
          <td class="paramname"><em>nut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_v3_d___matrix.html">V3D_Matrix</a> *&#160;</td>
          <td class="paramname"><em>nutM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This routine calculates the Nutation matrix, using the nutation in longitude, the nutation in obliquity, and the mean obliquity of the equator. </p>
<p>We calculate the Nutation matrix in a completely rigorous manner from the product of three rotation matrices:<br  />
 <b>N</b> = R1(-ε) × R3(-Δψ) × R1(ε0) where ε = ε0 + Δε (true obliquity of the equator) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nut</td><td>Angles Δψ, Δε and ε0, as returned by functions <a class="el" href="sky1_8h.html#a61813485e959ed0208086d946e33ad4c" title="Calculates the nutation in longitude and obliquity, according to the IAU 1980 Nutation Theory.">sky1_nutationIAU1980()</a> and <a class="el" href="sky1_8h.html#a956ebf3c1277943e770093830777ca0d" title="Calculate the obliquity of the ecliptic and the equation of the equinoxes.">sky1_epsilon1980()</a> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nutM</td><td>Nutation rotation matrix <b>N</b> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>References:</dt><dd><em>Astronomical Almanac</em> 2007, page B31<br  />
 also Mueller, p75</dd></dl>
<dl class="section user"><dt>When to call this function</dt><dd>Call it after you have called <a class="el" href="sky1_8h.html#a61813485e959ed0208086d946e33ad4c" title="Calculates the nutation in longitude and obliquity, according to the IAU 1980 Nutation Theory.">sky1_nutationIAU1980()</a> and <a class="el" href="sky1_8h.html#a956ebf3c1277943e770093830777ca0d" title="Calculate the obliquity of the ecliptic and the equation of the equinoxes.">sky1_epsilon1980()</a>. As mentioned for the other functions above, this need only be done infrequently. But also as mentioned, it is quite likely that you will not need to call this function directly. Any of the functions <a class="el" href="sky1_8h.html#ace44a5ea8db1f9ee75c14fd67daaa45e" title="Call the various precession and nutation routines in this module to create a combined precession and ...">sky1_createNPmatrix()</a>, <a class="el" href="star_8h.html#a65152f6caf32ee5c581fe7e54994b952" title="Calculate the position of the currently selected star (or other object outside the solar system) as a...">star_getApparent()</a>, <a class="el" href="star_8h.html#a18316f54644bd7ded2108492232be9d3" title="Calls star_getApparent() to calculate the star&#39;s position in apparent coordinates,...">star_getTopocentric()</a>, <a class="el" href="planet_8h.html#a96b2ba1bce82bbd875d0740576a24262" title="Calculate the position of the currently selected planet as a unit vector and a distance,...">planet_getApparent()</a> or <a class="el" href="planet_8h.html#ae551d337a5eb752a7e5e56417392e923" title="Calls planet_getApparent() to calculate the planet&#39;s position in apparent coordinates,...">planet_getTopocentric()</a> will call this routine for you.</dd></dl>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="sky1_8c_source.html#l00676">676</a> of file <a class="el" href="sky1_8c_source.html">sky1.c</a>.</p>

</div>
</div>
<a id="ace44a5ea8db1f9ee75c14fd67daaa45e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace44a5ea8db1f9ee75c14fd67daaa45e">&#9670;&nbsp;</a></span>sky1_createNPmatrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sky1_createNPmatrix </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t0_cy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t1_cy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>precision</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_v3_d___matrix.html">V3D_Matrix</a> *&#160;</td>
          <td class="paramname"><em>npM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Call the various precession and nutation routines in this module to create a combined precession and nutation rotation matrix, suitable for converting a celestial object's coordinates from mean place at epoch <em>t0_cy</em> to apparent coordinates at epoch <em>t1_cy</em>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t0_cy</td><td>Julian centuries since J2000.0 of initial epoch, TT timescale </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t1_cy</td><td>Julian centuries since J2000.0 of final epoch, TT timescale </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">precision</td><td>Precision specification to be passed to routine <a class="el" href="sky1_8h.html#a61813485e959ed0208086d946e33ad4c" title="Calculates the nutation in longitude and obliquity, according to the IAU 1980 Nutation Theory.">sky1_nutationIAU1980()</a>. See that routine for explanation </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">npM</td><td>Combined precession and nutation matrix <b>NP</b> = <b>N</b> × <b>P</b> </td></tr>
  </table>
  </dd>
</dl>
<p>This function calls routines <a class="el" href="sky1_8h.html#a443dfb8c35b2c9a7ed11e4f4df14e7df" title="This procedure calculates the equatorial precession parameters ζ, z, and θ which represent the rotati...">sky1_precessionIAU1976()</a>, <a class="el" href="sky1_8h.html#ac92f2acd0623795c195cbf848458c662" title="This routine calculates the precession matrix, based on angles ζ, z, and θ.">sky1_createPrec1976Matrix()</a>, <a class="el" href="sky1_8h.html#a61813485e959ed0208086d946e33ad4c" title="Calculates the nutation in longitude and obliquity, according to the IAU 1980 Nutation Theory.">sky1_nutationIAU1980()</a>, <a class="el" href="sky1_8h.html#a956ebf3c1277943e770093830777ca0d" title="Calculate the obliquity of the ecliptic and the equation of the equinoxes.">sky1_epsilon1980()</a> and <a class="el" href="sky1_8h.html#a13ed20ef8965385a267f14bb1965539f" title="This routine calculates the Nutation matrix, using the nutation in longitude, the nutation in obliqui...">sky1_createNut1980Matrix()</a> to calculate the precession and nutation matrices.</p>
<dl class="section user"><dt>When to call this function</dt><dd>Call this function if you are tracking non-solar system objects. The resulting matrix changes only very slowly, so this function needs to be called only once per hour.</dd></dl>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="sky1_8c_source.html#l00721">721</a> of file <a class="el" href="sky1_8c_source.html">sky1.c</a>.</p>

</div>
</div>
<a id="adf4ec009b45c88bb180898104cb7302a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf4ec009b45c88bb180898104cb7302a">&#9670;&nbsp;</a></span>sky1_gmSiderealTimeIAU1982()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double sky1_gmSiderealTimeIAU1982 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>du</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the Greenwich mean sidereal time. </p>
<dl class="section return"><dt>Returns</dt><dd>Greenwich Mean Sidereal Time (radian) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">du</td><td>Days since J2000.0, UT1 timescale</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Reference:</dt><dd><em>Astronomical Almanac</em> 1987, page B6</dd></dl>
<dl class="section user"><dt>When to call this function</dt><dd>If you are tracking a celestial object, you need not call this function directly. So long as you call <a class="el" href="sky1_8h.html#aa5023b9fbc0669c62f1422e13e5a6df1" title="Convert a position in geocentric apparent coordinates to geocentric coordinates in the Terrestrial In...">sky1_appToTirs()</a> every time around your control loop, it will call this function for you.</dd></dl>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="sky1_8c_source.html#l00766">766</a> of file <a class="el" href="sky1_8c_source.html">sky1.c</a>.</p>

</div>
</div>
<a id="aa5023b9fbc0669c62f1422e13e5a6df1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5023b9fbc0669c62f1422e13e5a6df1">&#9670;&nbsp;</a></span>sky1_appToTirs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sky1_appToTirs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_v3_d___vector.html">V3D_Vector</a> *&#160;</td>
          <td class="paramname"><em>appV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>j2kUT1_d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>eqEq_rad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_v3_d___vector.html">V3D_Vector</a> *&#160;</td>
          <td class="paramname"><em>terInterV</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a position in geocentric apparent coordinates to geocentric coordinates in the Terrestrial Intermediate Reference System. </p>
<p>This is the first stage of converting apparent coordinates to topocentric coordinates. The resulting vector depends upon the current rotational position of the Earth. (For the second stage, to obtain topocentric coordinates, call routine <a class="el" href="sky_8h.html#a0797b1e268ac7cc5b052c0623883eb74" title="Transform a coordinate vector from the Terrestrial Intermediate Reference System to topocentric Az/El...">sky_siteTirsToTopo()</a>). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">appV</td><td>Position vector of apparent place (unit vector in equatorial coordinates) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">j2kUT1_d</td><td>days since J2000.0, UT1 timescale, as returned by function <a class="el" href="sky_8h.html#a03279243991e42a3edbeaac243ae2dc7" title="Convert the given &quot;J2KD&quot; in the UTC timescale to the other timescales, and pre-calculate some other q...">sky_updateTimes()</a> in the <em>j2kUT1_d</em> field of the <a class="el" href="struct_sky___times.html" title="This structure contains the continuously varying time (and earth rotation) data, in various forms tha...">Sky_Times</a> struct. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eqEq_rad</td><td>Equation of the equinoxes (radian), as returned by function <a class="el" href="sky1_8h.html#a956ebf3c1277943e770093830777ca0d" title="Calculate the obliquity of the ecliptic and the equation of the equinoxes.">sky1_epsilon1980()</a> in the <em>eqEq_rad</em> field of the <a class="el" href="struct_sky1___nut1980.html" title="Nutation angles and obliquity.">Sky1_Nut1980</a> struct.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">terInterV</td><td>Position vector in Terrestrial Intermediate Ref System</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>When to call this function</dt><dd>When you have the position of a celestial object expressed in Apparent coordinates, use this function to convert it to Terrestrial coordinates at the relevant rotational position of the earth. (Effectively you are converting from Right Ascension and Declination to the negative of the Greenwich Hour Angle and Declination.) If you are running a control loop to enable continuous tracking of this object, you will need to call this function (once) every time around your control loop. </dd></dl>
<dl class="section user"><dt></dt><dd>Follow this function with a call to <a class="el" href="sky_8h.html#a0797b1e268ac7cc5b052c0623883eb74" title="Transform a coordinate vector from the Terrestrial Intermediate Reference System to topocentric Az/El...">sky_siteTirsToTopo()</a> to obtain the object's position in topocentric coordinates at the observing site.</dd></dl>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="sky1_8c_source.html#l00810">810</a> of file <a class="el" href="sky1_8c_source.html">sky1.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="sky1_8h.html">sky1.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
