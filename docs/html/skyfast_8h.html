<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Sun position: skyfast.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Sun position
   &#160;<span id="projectnumber">0.1.6-1</span>
   </div>
   <div id="projectbrief">Sun position algorithm</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('skyfast_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">skyfast.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="skyfast_8h.html" title="skyfast.h - set up and use interpolation for rapid calculation of a celestial object&#39;s apparent coord...">skyfast.h</a> - set up and use interpolation for rapid calculation of a celestial object's apparent coordinates.  
<a href="#details">More...</a></p>

<p><a href="skyfast_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac22205943c218e19d4313fc71dda43d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skyfast_8h.html#ac22205943c218e19d4313fc71dda43d4">skyfast_init</a> (double tStartUtc_d, int fullRecalcInterval_mins, const <a class="el" href="struct_sky___delta_ts.html">Sky_DeltaTs</a> *deltas, void(*getApparent)(double j2kTT_cy, <a class="el" href="struct_sky___true_equatorial.html">Sky_TrueEquatorial</a> *pos))</td></tr>
<tr class="memdesc:ac22205943c218e19d4313fc71dda43d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise those items that take a long time to calculate, but which do not need to be recalculated frequently.  <a href="skyfast_8h.html#ac22205943c218e19d4313fc71dda43d4">More...</a><br /></td></tr>
<tr class="separator:ac22205943c218e19d4313fc71dda43d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e351824c719ae6e465c1886a20a1a9c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skyfast_8h.html#a3e351824c719ae6e465c1886a20a1a9c">skyfast_backgroundUpdate</a> (void)</td></tr>
<tr class="memdesc:a3e351824c719ae6e465c1886a20a1a9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recalculation of the low frequency quantities.  <a href="skyfast_8h.html#a3e351824c719ae6e465c1886a20a1a9c">More...</a><br /></td></tr>
<tr class="separator:a3e351824c719ae6e465c1886a20a1a9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb9144e153624a3bf899af40eca07ac0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skyfast_8h.html#afb9144e153624a3bf899af40eca07ac0">skyfast_getApprox</a> (double t_cy, <a class="el" href="struct_sky___true_equatorial.html">Sky_TrueEquatorial</a> *approx)</td></tr>
<tr class="memdesc:afb9144e153624a3bf899af40eca07ac0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the best approximation to the celestial object's apparent coordinates and distance, and the equation of the equinoxes, based on an interpolation between two sets of such data that we have previously calculated.  <a href="skyfast_8h.html#afb9144e153624a3bf899af40eca07ac0">More...</a><br /></td></tr>
<tr class="separator:afb9144e153624a3bf899af40eca07ac0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="skyfast_8h.html" title="skyfast.h - set up and use interpolation for rapid calculation of a celestial object&#39;s apparent coord...">skyfast.h</a> - set up and use interpolation for rapid calculation of a celestial object's apparent coordinates. </p>
<dl class="section author"><dt>Author</dt><dd>David Hoadley</dd></dl>
<p>Routines to set up interpolation for celestial tracking, get the interpolated position at a given time, and to update the endpoints used by the interpolation algorithm. The error introduced by using interpolation rather than fully calculating each and every position can be very small - see <a class="el" href="page-interpolation.html">Interpolation and its errors</a> (the end of this source file)</p>
<hr  />
 
<p class="definition">Definition in file <a class="el" href="skyfast_8h_source.html">skyfast.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ac22205943c218e19d4313fc71dda43d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac22205943c218e19d4313fc71dda43d4">&#9670;&nbsp;</a></span>skyfast_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void skyfast_init </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tStartUtc_d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fullRecalcInterval_mins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_sky___delta_ts.html">Sky_DeltaTs</a> *&#160;</td>
          <td class="paramname"><em>deltas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(double j2kTT_cy, <a class="el" href="struct_sky___true_equatorial.html">Sky_TrueEquatorial</a> *pos)&#160;</td>
          <td class="paramname"><em>getApparent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise those items that take a long time to calculate, but which do not need to be recalculated frequently. </p>
<p>This routine calls a function that you supply to calculate the apparent coordinates of a celestial object, its distance, and the Equation of the Equinoxes, as derived from nutation calculations. This routine calls that function</p><ol type="1">
<li>for the time specified by <em>tStartUtc_d</em>,</li>
<li>for time <em>tStartUtc_d</em> + <em>fullRecalcalcInterval_mins</em>, and</li>
<li>for time <em>tStartUtc_d</em> + 2 x <em>fullRecalcalcInterval_mins</em>.</li>
</ol>
<p>For example, to track the Sun, specify the function <a class="el" href="sun_8h.html#a257ebc73aa83eef26448d451eeb086da" title="Calculate the Sun&#39;s position as a unit vector and a distance, in apparent coordinates.">sun_nrelApparent()</a> when calling this routine. To track the Moon, specify the function <a class="el" href="moon_8h.html#ae26dfd26ce7ba3a93eaa9ac24982016d" title="Calculate the Moon&#39;s position as a unit vector and a distance, in apparent coordinates.">moon_nrelApparent()</a>.</p>
<p>The routine <a class="el" href="skyfast_8h.html#afb9144e153624a3bf899af40eca07ac0" title="Get the best approximation to the celestial object&#39;s apparent coordinates and distance,...">skyfast_getApprox()</a> can then be called (at a high frequency if required) to calculate the current position of the object, using these values to do it. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tStartUtc_d</td><td>Time for first full calculation using function <em>getApparent()</em>. UTC time in "J2KD" form - i.e days since J2000.0 (= JD - 2 451 545.0) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fullRecalcInterval_mins</td><td>Interval of time between full recalculation of the object's position using the function supplied to <em>getApparent</em> (minutes). This value must be greater than zero. (Otherwise you will get a precondition failure.) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">deltas</td><td>Delta T values, as set by the <a class="el" href="sky_8h.html#abf770ba7cb996e73f59f41f24b172e3a" title="This is one of three alternative routines for setting up the various delta time values for use in ong...">sky_initTime()</a> (or <a class="el" href="sky_8h.html#a15ad9a782e54212cb22bd0658b6541a0" title="This is one of three alternative routines for setting up the various delta time values for use in ong...">sky_initTimeSimple()</a> or <a class="el" href="sky_8h.html#a4295dc6df66f02c4def3160782a06902" title="This is one of three alternative routines for setting up the various delta time values for use in ong...">sky_initTimeDetailed()</a>) routines </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">getApparent</td><td>Function to get the position of a celestial object in apparent coordinates (i.e. referred to the true equinox and equator at the time), in rectangular form.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>When to call this function</dt><dd>At program initialisation time. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Although the parameter name <em>getApparent</em> suggests that you must supply a function which calculates an object's position in apparent coordinates, it is also possible to supply a function which returns the position in Celestial Intermediate coordinates (i.e. referred to the true equator and the Celestial Intermediate Origin (CIO) at time <em>t_cy</em>) instead. If so, the function does not need to fill in the <em>eqEq_rad</em> field of struct <a class="el" href="struct_sky___true_equatorial.html" title="Struct used for holding an object&#39;s coordinates in equatorial apparent or Intermediate coordinates.">Sky_TrueEquatorial</a>.</dd></dl>
<hr  />
 <dl class="section examples"><dt>Examples</dt><dd><a class="el" href="demo2_sun_tracking_8c-example.html#a15">demo2_sun_tracking.c</a>, and <a class="el" href="demo4_multiple_sites_8c-example.html#a11">demo4_multiple_sites.c</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="skyfast_8c_source.html#l00111">111</a> of file <a class="el" href="skyfast_8c_source.html">skyfast.c</a>.</p>

</div>
</div>
<a id="a3e351824c719ae6e465c1886a20a1a9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e351824c719ae6e465c1886a20a1a9c">&#9670;&nbsp;</a></span>skyfast_backgroundUpdate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void skyfast_backgroundUpdate </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Recalculation of the low frequency quantities. </p>
<p>Checks whether the calculations of the celestial object's apparent coordinates and the equation of the equinoxes have been performed for the time called "oneAfter" (i.e. the time after the time called "next"). If they have not, this function performs those calculations.</p>
<p>This function calls the function that you previously supplied to function <a class="el" href="skyfast_8h.html#ac22205943c218e19d4313fc71dda43d4" title="Initialise those items that take a long time to calculate, but which do not need to be recalculated f...">skyfast_init()</a> (parameter <em>getApparent</em>).</p>
<dl class="section user"><dt>When to call this function</dt><dd>This function is designed to be called in a low priority loop, or at background level, using any available leftover processor time to slowly precalculate values for the "time after next". It needs to have been called before the high frequency routine <a class="el" href="skyfast_8h.html#afb9144e153624a3bf899af40eca07ac0" title="Get the best approximation to the celestial object&#39;s apparent coordinates and distance,...">skyfast_getApprox()</a> (which is interpolating between time "last" and time "next") arrives at time "next" and therefore needs to access the data for time "oneAfter".</dd></dl>
<hr  />
 
<p class="definition">Definition at line <a class="el" href="skyfast_8c_source.html#l00199">199</a> of file <a class="el" href="skyfast_8c_source.html">skyfast.c</a>.</p>

</div>
</div>
<a id="afb9144e153624a3bf899af40eca07ac0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb9144e153624a3bf899af40eca07ac0">&#9670;&nbsp;</a></span>skyfast_getApprox()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void skyfast_getApprox </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t_cy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_sky___true_equatorial.html">Sky_TrueEquatorial</a> *&#160;</td>
          <td class="paramname"><em>approx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the best approximation to the celestial object's apparent coordinates and distance, and the equation of the equinoxes, based on an interpolation between two sets of such data that we have previously calculated. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t_cy</td><td>Julian centuries since J2000.0, TT timescale. This must specify a time no earlier than the time specified in argument <em>tStartUtc_d</em> in the call to <a class="el" href="skyfast_8h.html#ac22205943c218e19d4313fc71dda43d4" title="Initialise those items that take a long time to calculate, but which do not need to be recalculated f...">skyfast_init()</a>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">approx</td><td>position vector, distance, etc, obtained by interpolation</td></tr>
  </table>
  </dd>
</dl>
<p>Although the position is described as approximate, the position returned can be very accurate, as shown in <a class="el" href="page-interpolation.html">Interpolation and its errors</a>, depending on the interpolation interval that was specified to routine <a class="el" href="skyfast_8h.html#ac22205943c218e19d4313fc71dda43d4" title="Initialise those items that take a long time to calculate, but which do not need to be recalculated f...">skyfast_init()</a>.</p>
<dl class="section note"><dt>Note</dt><dd>This function will return an approximate position in apparent coordinates (i.e. referred to the true equator and equinox at time <em>t_cy</em>) if the function that you passed to the <a class="el" href="skyfast_8h.html#ac22205943c218e19d4313fc71dda43d4" title="Initialise those items that take a long time to calculate, but which do not need to be recalculated f...">skyfast_init()</a> function returned apparent coordinates. This function will return an approximate position in Celestial Intermediate coordinates (i.e. referred to the true equator and the Celestial Intermediate Origin (CIO)) at time <em>t_cy</em>) if the function that you passed to the <a class="el" href="skyfast_8h.html#ac22205943c218e19d4313fc71dda43d4" title="Initialise those items that take a long time to calculate, but which do not need to be recalculated f...">skyfast_init()</a> function returned CIRS coordinates.</dd></dl>
<hr  />
 <dl class="section examples"><dt>Examples</dt><dd><a class="el" href="demo4_multiple_sites_8c-example.html#a14">demo4_multiple_sites.c</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="skyfast_8c_source.html#l00234">234</a> of file <a class="el" href="skyfast_8c_source.html">skyfast.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="skyfast_8h.html">skyfast.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
